var at=n=>n.key==="Escape",Y=n=>t=>{at(t)&&(t.preventDefault(),n())};function I(n,t,e,o,r){n.value.trim().length>t?(e.textContent=o,n.classList.add("has-error"),r.disabled=!0):(e.textContent="",n.classList.remove("has-error"),r.disabled=!1)}function B(n,t,e){let o=n.value.trim()!=="",r=!n.classList.contains("has-error"),s=!t.classList.contains("has-error");e.disabled=!o||!r||!s}function J(){let n=new Date,t={rendered:!1,localDate:new Date,prevMonthLastDate:null,calWeekDays:["\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431","\u0412\u0441"],calMonthName:["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0440\u0432\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],daysInMonth:function(e,o){return new Date(o,e,0).getDate()},firstDay:function(){return new Date(n.getFullYear(),n.getMonth(),1)},lastDay:function(){return new Date(n.getFullYear(),n.getMonth()+1,0)},firstDayNumber:function(){let e=t.firstDay().getDay();return e===0?7:e},lastDayNumber:function(){return t.lastDay().getDay()+1},getPreviousMonthLastDate:function(){return new Date(n.getFullYear(),n.getMonth(),0).getDate()},navigateToPreviousMonth:function(){n.setMonth(n.getMonth()-1),t.attachEventsOnNextPrev()},navigateToNextMonth:function(){n.setMonth(n.getMonth()+1),t.attachEventsOnNextPrev()},navigateToCurrentMonth:function(){let e=t.localDate.getMonth(),o=t.localDate.getFullYear();n.setMonth(e),n.setYear(o),t.attachEventsOnNextPrev()},displayYear:function(){let e=document.querySelector(".calendar .calendar-year-label");e.innerHTML=n.getFullYear()},displayMonth:function(){let e=document.querySelector(".calendar .calendar-month-label");e.innerHTML=t.calMonthName[n.getMonth()]},plotSelectors:function(){let e=document.querySelector(".calendar"),o=document.createElement("div");o.classList.add("calendar-inner");let r=document.createElement("div");r.classList.add("calendar-controls");let s=document.createElement("div");s.classList.add("calendar-prev");let p=document.createElement("a");p.setAttribute("href","#");let i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("width","128"),i.setAttribute("height","128"),i.setAttribute("viewBox","0 0 128 128");let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("fill","#666"),c.setAttribute("d","M88.2 3.8L35.8 56.23 28 64l7.8 7.78 52.4 52.4 9.78-7.76L45.58 64l52.4-52.4z"),i.appendChild(c),p.appendChild(i),s.appendChild(p);let a=document.createElement("div");a.classList.add("calendar-year-month");let C=document.createElement("div");C.classList.add("calendar-month-label");let E=document.createElement("div");E.textContent="-";let M=document.createElement("div");M.classList.add("calendar-year-label"),a.appendChild(C),a.appendChild(E),a.appendChild(M);let d=document.createElement("div");d.classList.add("calendar-next");let m=document.createElement("a");m.setAttribute("href","#");let u=document.createElementNS("http://www.w3.org/2000/svg","svg");u.setAttribute("xmlns","http://www.w3.org/2000/svg"),u.setAttribute("width","128"),u.setAttribute("height","128"),u.setAttribute("viewBox","0 0 128 128");let v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("fill","#666"),v.setAttribute("d","M38.8 124.2l52.4-52.42L99 64l-7.77-7.78-52.4-52.4-9.8 7.77L81.44 64 29 116.42z"),u.appendChild(v),m.appendChild(u),d.appendChild(m),r.appendChild(s),r.appendChild(a),r.appendChild(d);let S=document.createElement("div");S.classList.add("calendar-body"),o.appendChild(r),o.appendChild(S),e.appendChild(o)},plotDayNames:function(){let e=document.querySelector(".calendar .calendar-body");t.calWeekDays.forEach(o=>{let r=document.createElement("div");r.textContent=o,e.appendChild(r)})},plotDates:function(){let e=document.querySelector(".calendar .calendar-body");t.rendered||(t.plotSelectors(),t.rendered=!0),e.innerHTML="",t.plotDayNames(),t.displayMonth(),t.displayYear();let o=1,r=0;t.prevMonthLastDate=t.getPreviousMonthLastDate();let s=[],p=t.daysInMonth(n.getMonth()+1,n.getFullYear());for(let i=1;i<p;i++)if(i<t.firstDayNumber()){r+=1;let c=document.createElement("div");c.classList.add("prev-dates"),e.appendChild(c),s.push(t.prevMonthLastDate--)}else{let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",o);let a=document.createElement("a");a.classList.add("dateNumber"),a.href="#",a.textContent=o++,c.appendChild(a),e.appendChild(c)}for(let i=0;i<r+1;i++){let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",o);let a=document.createElement("a");a.classList.add("dateNumber"),a.href="#",a.textContent=o++,c.appendChild(a),e.appendChild(c)}t.highlightToday(),t.plotPrevMonthDates(s),t.plotNextMonthDates()},attachEvents:function(){let e=document.querySelector(".calendar .calendar-prev a"),o=document.querySelector(".calendar .calendar-next a"),r=document.querySelectorAll(".calendar .dateNumber");e.addEventListener("click",t.navigateToPreviousMonth),o.addEventListener("click",t.navigateToNextMonth);for(var s=0;s<r.length;s++)r[s].addEventListener("click",t.selectDate,!1)},highlightToday:function(){let e=t.localDate.getMonth()+1,o=n.getMonth()+1,r=t.localDate.getFullYear(),s=n.getFullYear();r===s&&e===o&&document.querySelectorAll(".number-item")&&document.querySelectorAll(".number-item")[n.getDate()-1].classList.add("calendar-today")},plotPrevMonthDates:function(e){e.reverse();for(let o=0;o<e.length;o++)document.querySelectorAll(".prev-dates")&&(document.querySelectorAll(".prev-dates")[o].textContent=e[o])},plotNextMonthDates:function(){let e=document.querySelector(".calendar-body").childElementCount;if(e>42){let o=49-e;t.loopThroughNextDays(o)}if(e>35&&e<=42){let o=42-e;t.loopThroughNextDays(42-e)}},loopThroughNextDays:function(e){let o=document.querySelector(".calendar-body");if(e>0)for(let r=1;r<=e;r++){let s=document.createElement("div");s.classList.add("next-dates"),s.textContent=r,o.appendChild(s)}},attachEventsOnNextPrev:function(){t.plotDates(),t.attachEvents()},init:function(){t.rendered||(t.plotSelectors(),t.rendered=!0),t.plotDates(),t.attachEvents()}};t.init()}function Q(){document.querySelectorAll(".editor").forEach(t=>{t.addEventListener("input",()=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"})})}function Z(n){let t=document.getElementById("dateInput"),e=document.querySelector(".calendar"),o=document.getElementById("priorityInput"),r=document.querySelector(".popup-priority"),s=document.querySelectorAll(".popup-priority__item"),p=document.querySelector(".task-editor__priority-label"),i=document.getElementById("projectInput"),c=document.querySelector(".popup-project"),a=document.querySelector(".popup-project__list"),C=document.querySelector(".popup-project_btn-reset"),E=document.querySelector(".popup-project__list-empty"),M=new J;function d(l,y,L){return function(g){g.stopPropagation(),l.classList.contains("task-editor__popup--open")?L():y()}}o.addEventListener("click",d(r,h,_)),i.addEventListener("click",d(c,w,x)),C.addEventListener("click",()=>{i.value="",x()}),s.forEach(function(l){l.addEventListener("click",function(){let y=l.textContent.trim();switch(o.value=y,p.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),y){case"\u0421\u0440\u043E\u0447\u043D\u043E":p.classList.add("task-editor__priority-label--priority1");break;case"\u0412\u0430\u0436\u043D\u043E":p.classList.add("task-editor__priority-label--priority2");break;case"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":p.classList.add("task-editor__priority-label--priority3");break;default:break}_()})}),t.value=n,t.addEventListener("click",()=>{e.style.display==="block"?b():P()}),e.addEventListener("click",function(l){if(l.target.classList.contains("dateNumber")){let y=l.target.textContent.trim(),L=e.querySelector(".calendar-month-label").textContent.trim();t.value=`${y} ${L}`,b()}});let m=Y(_),u=Y(x),v=Y(b);function S(){b(),_(),x()}function A(l,y){S(),l.classList.add("task-editor__popup--open"),document.addEventListener("keydown",y)}function q(l,y){l.classList.remove("task-editor__popup--open"),document.removeEventListener("keydown",y)}function h(){A(r,m)}function _(){q(r,m)}function w(){A(c,u),k()}function x(){q(c,u)}function P(){S(),e.style.display="block",document.addEventListener("keydown",v)}function b(){e.style.display="none",document.removeEventListener("keydown",v)}function k(){let y=document.querySelector(".projects__list-wrapper").querySelectorAll(".project__title");a.innerHTML="",y.forEach(L=>{let g=document.createElement("li");g.classList.add("popup-project__item");let $=document.createElement("span");$.textContent=L.textContent.trim(),g.appendChild($),a.appendChild(g),g.addEventListener("click",function(){let D=g.textContent.trim();i.value=D,x()})}),T()}function T(){document.querySelectorAll(".popup-project__list li").length===0?E.style.display="block":E.style.display="none"}document.addEventListener("click",function(l){!r.contains(l.target)&&l.target!==o&&_(),!c.contains(l.target)&&l.target!==i&&x(),!e.contains(l.target)&&l.target!==t&&b()})}var ht=document.querySelector(".sidebar"),ft=document.querySelectorAll(".new-item"),O=100,W=500,j={TITLE:"\u0414\u043B\u0438\u043D\u0430 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0430 \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 100 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432.",DISC:"\u0414\u043B\u0438\u043D\u0430 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u044F \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 500 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432."};var X=document.querySelector(".button-date"),V=X.querySelector(".button-date__title"),U=X.querySelector(".button-date__arrow--left"),G=X.querySelector(".button-date__arrow--right"),st=document.querySelector(".dashboard .list-with-tasks__wrapper"),f=new Date;K();N();G.addEventListener("click",function(){G.classList.contains("button-date__arrow--disabled")||(f.setDate(f.getDate()+1),K(),N())});U.addEventListener("click",function(){U.classList.contains("button-date__arrow--disabled")||(f.setDate(f.getDate()-1),K(),N())});function K(){let n=new Date,t=new Date(n);t.setDate(t.getDate()+1),H(f,n)?V.textContent="\u0421\u0435\u0433\u043E\u0434\u043D\u044F":H(f,t)?V.textContent="\u0417\u0430\u0432\u0442\u0440\u0430":V.textContent=it(f),ct()}function ct(){let n=new Date,t="button-date__arrow--disabled";U.classList.toggle(t,H(f,n)),G.classList.toggle(t,lt(f,n))}function N(){let n=st.querySelectorAll(".task"),t=/(\d+)\s+(\S+)/;n.forEach(e=>{let o=e.querySelector(".task__data").textContent;if(o.trim()==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){e.classList.add("task--hidden");return}if(e.classList.contains("task--completed")){e.classList.add("task--hidden");return}let[,r,s]=o.match(t),p=new Date(f.getFullYear(),z(s),parseInt(r));H(f,p)?e.classList.remove("task--hidden"):e.classList.add("task--hidden")})}function it(n){let t={weekday:"long",month:"long",day:"numeric"};return n.toLocaleDateString("ru-RU",t)}function H(n,t){return n.getFullYear()===t.getFullYear()&&n.getMonth()===t.getMonth()&&n.getDate()===t.getDate()}function lt(n,t){let e=new Date(t.getFullYear(),t.getMonth(),t.getDate()+7);return n>=e}function z(n){return["\u042F\u043D\u0432","\u0424\u0435\u0432","\u041C\u0430\u0440","\u0410\u043F\u0440","\u041C\u0430\u0439","\u0418\u044E\u043D","\u0418\u044E\u043B","\u0410\u0432\u0433","\u0421\u0435\u043D","\u041E\u043A\u0442","\u041D\u043E\u044F","\u0414\u0435\u043A"].indexOf(n)}var tt=document.querySelectorAll(".tasks__header-button"),et=document.querySelector(".tasks .list-with-tasks__wrapper");tt.forEach(n=>{n.addEventListener("click",function(){tt.forEach(t=>t.classList.remove("tasks__header-button--active")),n.classList.add("tasks__header-button--active"),R(n.textContent.trim())})});function R(n){et.querySelectorAll(".task").forEach(e=>{n==="\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0435"?e.classList.contains("task--completed")?e.classList.remove("task--hidden"):e.classList.add("task--hidden"):n==="\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0435"?e.classList.contains("task--completed")||e.classList.contains("task--expired")?e.classList.add("task--hidden"):e.classList.remove("task--hidden"):n==="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&(e.classList.contains("task--expired")?e.classList.remove("task--hidden"):e.classList.add("task--hidden"))})}function nt(){let n=et.querySelectorAll(".task"),t=new Date;t.setHours(0,0,0,0),n.forEach(e=>{let o=e.querySelector(".task__data").textContent.trim();if(o==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){e.classList.add("task--hidden");return}let[,r,s]=o.match(/(\d+)\s+(\S+)/);if(new Date(t.getFullYear(),z(s),parseInt(r)).getTime()<t.getTime()){e.classList.add("task--expired");let i=e.querySelector(".task__info-wrapper");if(!i.querySelector(".task__info-expired")){let c=document.createElement("span");c.classList.add("task__info-expired"),c.textContent="\u0417\u0430\u0434\u0430\u0447\u0430 \u043F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u0430",i.insertBefore(c,i.firstChild)}document.querySelector(".tasks__header-button--active").textContent!=="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&e.classList.add("task--hidden")}else{e.classList.remove("task--expired");let i=e.querySelector(".task__info-expired");i&&i.remove()}})}function ot(n,t,e=null){document.querySelectorAll(n).forEach(r=>{r.addEventListener("click",()=>{let s=r.closest(t);if(s)if(e){let p=s.dataset.id;document.querySelectorAll(`${t}[${e}="${p}"]`).forEach(c=>{c.remove()})}else s.remove()})})}function rt(n,t,e,o,r,s){let p=document.querySelectorAll(n),i=document.querySelector(e);p.forEach(c=>{c.addEventListener("click",()=>{let a=c.closest(t);if(a.classList.add(`${t.slice(1)}--edit`),a){let C=a.dataset.id,E=a.querySelector(o).textContent.trim(),M=a.querySelector(r).textContent.trim(),d=i.content.cloneNode(!0).querySelector(".task-editor"),m=d.querySelector('[name="title_task"]'),u=d.querySelector('[name="discription_task"]'),v=d.querySelector('[name="data_task"]'),S=d.querySelector('[name="priority_task"]'),A=d.querySelector('[name="project_task"]'),q=d.querySelector(".task-editor__priority-label"),h=d.querySelector(".task-editor__submit-btn"),_=document.createElement("span"),w=document.createElement("span");m.value=E,u.value=M,_.classList.add("task-editor__error"),w.classList.add("task-editor__error"),m.parentNode.appendChild(_),u.parentNode.appendChild(w),m.addEventListener("input",()=>{I(m,O,_,j.TITLE,h),B(m,u,h)}),u.addEventListener("input",()=>{I(u,W,w,j.DISC,h),B(m,u,h)}),B(m,u,h),h.querySelector("use").setAttribute("href","icons/stack.svg#checkmark"),h.addEventListener("click",()=>{if(I(m,O,_,j.TITLE,h),I(u,W,w,j.DISC,h),m.classList.contains("has-error")||u.classList.contains("has-error"))return;let k=m.value.trim(),T=u.value.trim();if(a.querySelector(o).textContent=k,a.querySelector(r).textContent=T,s){let y=v.value.trim(),L=S.value.trim(),g=A.value.trim();document.querySelectorAll(`.task[data-id="${C}"]`).forEach(D=>{D.querySelector(".task__title").textContent=k,D.querySelector(".task__discription").textContent=T,D.querySelector(".task__data").textContent=y,D.querySelector(".task__project").textContent=g;let F=D.querySelector(".task__circle");F.classList.remove("task__circle--priority1","task__circle--priority2","task__circle--priority3"),L==="\u0421\u0440\u043E\u0447\u043D\u043E"?F.classList.add("task__circle--priority1"):L==="\u0412\u0430\u0436\u043D\u043E"?F.classList.add("task__circle--priority2"):L==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&F.classList.add("task__circle--priority3")})}d.classList.add("task-editor--hidden"),d.addEventListener("transitionend",function y(){a.classList.remove(`${t.slice(1)}--edit`),d.remove(),d.removeEventListener("transitionend",y)},{once:!0}),N(),nt();let l=document.querySelector(".tasks__header-button--active").textContent.trim();R(l)});let P=a.closest(".list, .projects__list").querySelector(".manager-item");P.innerHTML="",P.appendChild(d),d.classList.add("task-editor--visible");let b=d.querySelector(".task-editor__close-btn");if(b&&b.addEventListener("click",()=>{d.classList.add("task-editor--hidden"),d.addEventListener("transitionend",function k(){a.classList.remove(`${t.slice(1)}--edit`),d.remove(),d.removeEventListener("transitionend",k)},{once:!0})}),s){let k=a.querySelector(".task__data").textContent.trim(),T=a.querySelector(".task__project").textContent.trim(),l=a.querySelector(".task__circle").classList.contains("task__circle--priority1")?"\u0421\u0440\u043E\u0447\u043D\u043E":a.querySelector(".task__circle").classList.contains("task__circle--priority2")?"\u0412\u0430\u0436\u043D\u043E":a.querySelector(".task__circle").classList.contains("task__circle--priority3")?"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":"";v.value=k,A.value=T,S.value=l,l==="\u0421\u0440\u043E\u0447\u043D\u043E"?q.classList.add("task-editor__priority-label--priority1"):l==="\u0412\u0430\u0436\u043D\u043E"?q.classList.add("task-editor__priority-label--priority2"):l==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&q.classList.add("task-editor__priority-label--priority3"),Z(k)}Q()}})})}function Dt(){ot(".button-delete-task",".task","data-id")}function Ct(){ot(".button-delete-project",".project")}function qt(){rt(".button-edit-task",".task","#task-editor",".task__title",".task__discription",!0)}function wt(){rt(".button-edit-project",".project","#project-editor",".project__title",".project__discription",!1)}export{Ct as deleteProject,Dt as deleteTask,wt as editProject,qt as editTask};
