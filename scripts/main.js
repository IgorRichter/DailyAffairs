var F=document.querySelector(".sidebar"),H=document.querySelectorAll(".new-item"),$=100,V=500,x={TITLE:"\u0414\u043B\u0438\u043D\u0430 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0430 \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 100 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432.",DISC:"\u0414\u043B\u0438\u043D\u0430 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u044F \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 500 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432."};var qt=document.querySelector(".sidebar__button"),et=document.querySelector(".dropdown-menu"),Rt=document.querySelector(".dropdown-menu__item--arrow"),Qt=document.querySelector(".dropdown-menu__submenu"),bt=document.querySelector(".sidebar__user-button");qt.addEventListener("click",()=>{F.classList.toggle("sidebar--open"),document.body.style.overflow=F.classList.contains("sidebar--open")?"hidden":"auto"});bt.addEventListener("click",()=>{et.classList.toggle("dropdown-menu--open")});Rt.addEventListener("click",()=>{Qt.classList.toggle("dropdown-menu__submenu--open")});document.addEventListener("click",t=>{!F.contains(t.target)&&!qt.contains(t.target)&&(F.classList.remove("sidebar--open"),document.body.style.overflow=F.classList.contains("sidebar--open")?"hidden":"auto"),!et.contains(t.target)&&!bt.contains(t.target)&&et.classList.remove("dropdown-menu--open")});var nt=document.querySelector(".button-date"),ot=nt.querySelector(".button-date__title"),st=nt.querySelector(".button-date__arrow--left"),rt=nt.querySelector(".button-date__arrow--right"),Zt=document.querySelector(".dashboard .list-with-tasks__wrapper"),q=new Date;at();j();rt.addEventListener("click",function(){rt.classList.contains("button-date__arrow--disabled")||(q.setDate(q.getDate()+1),at(),j())});st.addEventListener("click",function(){st.classList.contains("button-date__arrow--disabled")||(q.setDate(q.getDate()-1),at(),j())});function at(){let t=new Date,e=new Date(t);e.setDate(e.getDate()+1),X(q,t)?ot.textContent="\u0421\u0435\u0433\u043E\u0434\u043D\u044F":X(q,e)?ot.textContent="\u0417\u0430\u0432\u0442\u0440\u0430":ot.textContent=ee(q),te()}function te(){let t=new Date,e="button-date__arrow--disabled";st.classList.toggle(e,X(q,t)),rt.classList.toggle(e,oe(q,t))}function j(){let t=Zt.querySelectorAll(".task"),e=/(\d+)\s+(\S+)/;t.forEach(o=>{let s=o.querySelector(".task__data").textContent;if(s.trim()==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){o.classList.add("task--hidden");return}if(o.classList.contains("task--completed")){o.classList.add("task--hidden");return}let[,r,a]=s.match(e),i=new Date(q.getFullYear(),ct(a),parseInt(r));X(q,i)?o.classList.remove("task--hidden"):o.classList.add("task--hidden")})}function ee(t){let e={weekday:"long",month:"long",day:"numeric"};return t.toLocaleDateString("ru-RU",e)}function X(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}function oe(t,e){let o=new Date(e.getFullYear(),e.getMonth(),e.getDate()+7);return t>=o}function ct(t){return["\u042F\u043D\u0432","\u0424\u0435\u0432","\u041C\u0430\u0440","\u0410\u043F\u0440","\u041C\u0430\u0439","\u0418\u044E\u043D","\u0418\u044E\u043B","\u0410\u0432\u0433","\u0421\u0435\u043D","\u041E\u043A\u0442","\u041D\u043E\u044F","\u0414\u0435\u043A"].indexOf(t)}var Ct=document.querySelectorAll(".tasks__header-button"),Tt=document.querySelector(".tasks .list-with-tasks__wrapper");Ct.forEach(t=>{t.addEventListener("click",function(){Ct.forEach(e=>e.classList.remove("tasks__header-button--active")),t.classList.add("tasks__header-button--active"),O(t.textContent.trim())})});function O(t){Tt.querySelectorAll(".task").forEach(o=>{t==="\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0435"?o.classList.contains("task--completed")?o.classList.remove("task--hidden"):o.classList.add("task--hidden"):t==="\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0435"?o.classList.contains("task--completed")||o.classList.contains("task--expired")?o.classList.add("task--hidden"):o.classList.remove("task--hidden"):t==="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&(o.classList.contains("task--expired")?o.classList.remove("task--hidden"):o.classList.add("task--hidden"))})}function se(t){document.querySelectorAll(`.task[data-id="${t}"]`).forEach(o=>{jt(o)})}function xt(){it().forEach(e=>{se(e)})}function W(t){localStorage.setItem("completedTasks",JSON.stringify(t))}function it(){let t=localStorage.getItem("completedTasks");return t?JSON.parse(t):[]}function jt(t){let e=t.querySelector(".task__title"),o=t.dataset.id;t.classList.add("task--completed");let s=document.createElement("s");s.textContent=e.textContent,e.textContent="",e.appendChild(s),t.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#arrow-back");let a=it(),i=ut();i=i.filter(c=>c!==o),dt(i),a.push(o),W(a),a.includes(o)||(a.push(o),W(a)),a.push(o),W(a),t.style.transition="opacity 0.3s ease",t.style.opacity="0",setTimeout(()=>{t.classList.add("task--completed","task--hidden"),t.style.transition="",t.style.opacity=""},300),document.querySelectorAll('.list-with-tasks__wrapper .task[data-id="'+o+'"]').forEach(c=>{c.classList.add("task--completed");let n=c.querySelector(".task__title");if(!n.querySelector("s")){let p=document.createElement("s");p.textContent=n.textContent,n.textContent="",n.appendChild(p)}if(c.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#arrow-back"),c.classList.contains("task--expired")){c.classList.remove("task--expired");let p=c.querySelector(".task__info-expired");p&&p.remove()}})}function lt(){document.querySelectorAll(".button-complete-task").forEach(e=>{e.addEventListener("click",function(o){let s=o.target.closest(".task");s.classList.contains("task--completed")?re(s):jt(s)})})}function re(t){let e=t.querySelector(".task__title s");e&&(e.parentNode.textContent=e.textContent),t.classList.remove("task--completed"),t.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#checkmark");let s=t.dataset.id,r=it();r=r.filter(n=>n!==s),W(r);let a=ut();a=a.filter(n=>n!==s),dt(a);let i=r.indexOf(s);i!==-1&&(r.splice(i,1),W(r)),r=r.filter(n=>n!==s),W(r),document.querySelectorAll('.list-with-tasks__wrapper .task[data-id="'+s+'"]').forEach(n=>{let d=n.querySelector(".task__title s");d&&(d.parentNode.textContent=d.textContent),n.classList.remove("task--completed"),n.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#checkmark")});let c=document.querySelector(".tasks__header-button--active");if(c){let n=c.textContent.trim();O(n)}U()}function wt(){let t=ut();document.querySelectorAll(".task").forEach(o=>{let s=o.dataset.id;t.includes(s)&&U()})}function dt(t){localStorage.setItem("expiredTasks",JSON.stringify(t))}function ut(){let t=localStorage.getItem("expiredTasks");return t?JSON.parse(t):[]}function U(){let t=Tt.querySelectorAll(".task"),e=new Date;e.setHours(0,0,0,0);let o=[];t.forEach(s=>{let r=s.dataset.id,a=s.querySelector(".task__data").textContent.trim();if(a==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){s.classList.add("task--hidden");return}let[,i,l]=a.match(/(\d+)\s+(\S+)/);if(new Date(e.getFullYear(),ct(l),parseInt(i)).getTime()<e.getTime()){s.classList.add("task--expired");let n=s.querySelector(".task__info-wrapper");if(!n.querySelector(".task__info-expired")){let p=document.createElement("span");p.classList.add("task__info-expired"),p.textContent="\u0417\u0430\u0434\u0430\u0447\u0430 \u043F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u0430",n.insertBefore(p,n.firstChild)}let d=document.querySelector(".tasks__header-button--active");d&&d.textContent!=="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&s.classList.add("task--hidden"),o.push(r)}else{s.classList.remove("task--expired");let n=s.querySelector(".task__info-expired");n&&n.remove()}}),dt(o)}var ne=document.querySelectorAll(".nav__item a"),ae=document.querySelectorAll(".nav__link"),ce=document.querySelector(".app-header__title"),ie=document.querySelectorAll(".manager-item");ne.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault(),ie.forEach(d=>{d.innerHTML=""}),document.querySelectorAll(".tasks__header-button").forEach(d=>{d.classList.remove("tasks__header-button--active"),d.textContent.trim()==="\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0435"&&d.classList.add("tasks__header-button--active");let p=document.querySelector(".tasks__header-button--active").textContent.trim();O(p)}),j();let s=document.querySelectorAll(".task"),r=document.querySelectorAll(".project");s.forEach(d=>{d.classList.remove("task--edit")}),r.forEach(d=>{d.classList.remove("project--edit")}),H.forEach(d=>{d.classList.remove("new-item--disabled")}),ae.forEach(d=>{d.classList.remove("nav__link--active")}),t.classList.add("nav__link--active"),F.classList.remove("sidebar--open");let a=t.textContent;ce.textContent=a;let i=t.getAttribute("data-section"),l=document.querySelectorAll(".section");for(var c=0;c<l.length;c++)l[c].style.display="none";let n=document.getElementById(i);n&&(n.style.display="block")})});var le=t=>t.key==="Escape",K=t=>e=>{le(e)&&(e.preventDefault(),t())};function Dt(){return Math.random().toString(36).substr(2,9)}var pt=function(){let t=0;return function(){return t++,t}}(),It=()=>{let t=new Date,e=t.getDate(),o=["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0432\u0440\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],s=t.getMonth(),r=o[s];return`${e} ${r}`};function w(t,e,o,s,r){t.value.trim().length>e?(o.textContent=s,t.classList.add("has-error"),r.disabled=!0):(o.textContent="",t.classList.remove("has-error"),r.disabled=!1)}function P(t,e,o){let s=t.value.trim()!=="",r=!t.classList.contains("has-error"),a=!e.classList.contains("has-error");o.disabled=!s||!r||!a}function mt(t){let e=t.trim().split(" "),o=parseInt(e[0]),s=de(e[1]),r=new Date().getFullYear();return new Date(r,s,o)}function de(t){return{\u042F\u043D\u0432\u0430\u0440\u044C:0,\u0424\u0435\u0432\u0440\u0430\u043B\u044C:1,\u041C\u0430\u0440\u0442:2,\u0410\u043F\u0440\u0435\u043B\u044C:3,\u041C\u0430\u0439:4,\u0418\u044E\u043D\u044C:5,\u0418\u044E\u043B\u044C:6,\u0410\u0432\u0433\u0443\u0441\u0442:7,\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C:8,\u041E\u043A\u0442\u044F\u0431\u0440\u044C:9,\u041D\u043E\u044F\u0431\u0440\u044C:10,\u0414\u0435\u043A\u0430\u0431\u0440\u044C:11}[t]}function At(){let t=new Date,e={rendered:!1,localDate:new Date,prevMonthLastDate:null,calWeekDays:["\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431","\u0412\u0441"],calMonthName:["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0440\u0432\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],daysInMonth:function(o,s){return new Date(s,o,0).getDate()},firstDay:function(){return new Date(t.getFullYear(),t.getMonth(),1)},lastDay:function(){return new Date(t.getFullYear(),t.getMonth()+1,0)},firstDayNumber:function(){let o=e.firstDay().getDay();return o===0?7:o},lastDayNumber:function(){return e.lastDay().getDay()+1},getPreviousMonthLastDate:function(){return new Date(t.getFullYear(),t.getMonth(),0).getDate()},navigateToPreviousMonth:function(){t.setMonth(t.getMonth()-1),e.attachEventsOnNextPrev()},navigateToNextMonth:function(){t.setMonth(t.getMonth()+1),e.attachEventsOnNextPrev()},navigateToCurrentMonth:function(){let o=e.localDate.getMonth(),s=e.localDate.getFullYear();t.setMonth(o),t.setYear(s),e.attachEventsOnNextPrev()},displayYear:function(){let o=document.querySelector(".calendar .calendar-year-label");o.innerHTML=t.getFullYear()},displayMonth:function(){let o=document.querySelector(".calendar .calendar-month-label");o.innerHTML=e.calMonthName[t.getMonth()]},plotSelectors:function(){let o=document.querySelector(".calendar"),s=document.createElement("div");s.classList.add("calendar-inner");let r=document.createElement("div");r.classList.add("calendar-controls");let a=document.createElement("div");a.classList.add("calendar-prev");let i=document.createElement("a");i.setAttribute("href","#");let l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("width","128"),l.setAttribute("height","128"),l.setAttribute("viewBox","0 0 128 128");let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("fill","#666"),c.setAttribute("d","M88.2 3.8L35.8 56.23 28 64l7.8 7.78 52.4 52.4 9.78-7.76L45.58 64l52.4-52.4z"),l.appendChild(c),i.appendChild(l),a.appendChild(i);let n=document.createElement("div");n.classList.add("calendar-year-month");let d=document.createElement("div");d.classList.add("calendar-month-label");let p=document.createElement("div");p.textContent="-";let C=document.createElement("div");C.classList.add("calendar-year-label"),n.appendChild(d),n.appendChild(p),n.appendChild(C);let m=document.createElement("div");m.classList.add("calendar-next");let _=document.createElement("a");_.setAttribute("href","#");let k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttribute("xmlns","http://www.w3.org/2000/svg"),k.setAttribute("width","128"),k.setAttribute("height","128"),k.setAttribute("viewBox","0 0 128 128");let g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("fill","#666"),g.setAttribute("d","M38.8 124.2l52.4-52.42L99 64l-7.77-7.78-52.4-52.4-9.8 7.77L81.44 64 29 116.42z"),k.appendChild(g),_.appendChild(k),m.appendChild(_),r.appendChild(a),r.appendChild(n),r.appendChild(m);let L=document.createElement("div");L.classList.add("calendar-body"),s.appendChild(r),s.appendChild(L),o.appendChild(s)},plotDayNames:function(){let o=document.querySelector(".calendar .calendar-body");e.calWeekDays.forEach(s=>{let r=document.createElement("div");r.textContent=s,o.appendChild(r)})},plotDates:function(){let o=document.querySelector(".calendar .calendar-body");e.rendered||(e.plotSelectors(),e.rendered=!0),o.innerHTML="",e.plotDayNames(),e.displayMonth(),e.displayYear();let s=1,r=0;e.prevMonthLastDate=e.getPreviousMonthLastDate();let a=[],i=e.daysInMonth(t.getMonth()+1,t.getFullYear());for(let l=1;l<i;l++)if(l<e.firstDayNumber()){r+=1;let c=document.createElement("div");c.classList.add("prev-dates"),o.appendChild(c),a.push(e.prevMonthLastDate--)}else{let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",s);let n=document.createElement("a");n.classList.add("dateNumber"),n.href="#",n.textContent=s++,c.appendChild(n),o.appendChild(c)}for(let l=0;l<r+1;l++){let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",s);let n=document.createElement("a");n.classList.add("dateNumber"),n.href="#",n.textContent=s++,c.appendChild(n),o.appendChild(c)}e.highlightToday(),e.plotPrevMonthDates(a),e.plotNextMonthDates()},attachEvents:function(){let o=document.querySelector(".calendar .calendar-prev a"),s=document.querySelector(".calendar .calendar-next a"),r=document.querySelectorAll(".calendar .dateNumber");o.addEventListener("click",e.navigateToPreviousMonth),s.addEventListener("click",e.navigateToNextMonth);for(var a=0;a<r.length;a++)r[a].addEventListener("click",e.selectDate,!1)},highlightToday:function(){let o=e.localDate.getMonth()+1,s=t.getMonth()+1,r=e.localDate.getFullYear(),a=t.getFullYear();r===a&&o===s&&document.querySelectorAll(".number-item")&&document.querySelectorAll(".number-item")[t.getDate()-1].classList.add("calendar-today")},plotPrevMonthDates:function(o){o.reverse();for(let s=0;s<o.length;s++)document.querySelectorAll(".prev-dates")&&(document.querySelectorAll(".prev-dates")[s].textContent=o[s])},plotNextMonthDates:function(){let o=document.querySelector(".calendar-body").childElementCount;if(o>42){let s=49-o;e.loopThroughNextDays(s)}if(o>35&&o<=42){let s=42-o;e.loopThroughNextDays(42-o)}},loopThroughNextDays:function(o){let s=document.querySelector(".calendar-body");if(o>0)for(let r=1;r<=o;r++){let a=document.createElement("div");a.classList.add("next-dates"),a.textContent=r,s.appendChild(a)}},attachEventsOnNextPrev:function(){e.plotDates(),e.attachEvents()},init:function(){e.rendered||(e.plotSelectors(),e.rendered=!0),e.plotDates(),e.attachEvents()}};e.init()}function z(){document.querySelectorAll(".editor").forEach(e=>{e.addEventListener("input",()=>{e.style.height="auto",e.style.height=e.scrollHeight+"px"})})}function R(t){let e=document.getElementById("dateInput"),o=document.querySelector(".calendar"),s=document.getElementById("priorityInput"),r=document.querySelector(".popup-priority"),a=document.querySelectorAll(".popup-priority__item"),i=document.querySelector(".task-editor__priority-label"),l=document.getElementById("projectInput"),c=document.querySelector(".popup-project"),n=document.querySelector(".popup-project__list"),d=document.querySelector(".popup-project_btn-reset"),p=document.querySelector(".popup-project__list-empty"),C=new At;function m(u,y,h){return function(E){E.stopPropagation(),u.classList.contains("task-editor__popup--open")?h():y()}}if(s.addEventListener("click",m(r,f,v)),!l.closest(".list-in-project"))l.addEventListener("click",m(c,N,A));else{let u=document.querySelector(".projects-task").dataset.project;l.value=u}d.addEventListener("click",()=>{l.value="";let y=document.querySelector(".task-editor").dataset.taskId,h=document.querySelector(`.task[data-id="${y}"]`);h&&delete h.dataset.project,A()}),a.forEach(function(u){u.addEventListener("click",function(){let y=u.textContent.trim();switch(s.value=y,i.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),y){case"\u0421\u0440\u043E\u0447\u043D\u043E":i.classList.add("task-editor__priority-label--priority1");break;case"\u0412\u0430\u0436\u043D\u043E":i.classList.add("task-editor__priority-label--priority2");break;case"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":i.classList.add("task-editor__priority-label--priority3");break;default:break}v()})}),e.value=t,e.addEventListener("click",()=>{o.style.display==="block"?T():Y()}),o.addEventListener("click",function(u){if(u.target.classList.contains("dateNumber")){let y=u.target.textContent.trim(),h=o.querySelector(".calendar-month-label").textContent.trim();e.value=`${y} ${h}`,T()}});let _=K(v),k=K(A),g=K(T);function L(){T(),v(),A()}function D(u,y){L(),u.classList.add("task-editor__popup--open"),document.addEventListener("keydown",y)}function I(u,y){u.classList.remove("task-editor__popup--open"),document.removeEventListener("keydown",y)}function f(){D(r,_)}function v(){I(r,_)}function N(){D(c,k),S()}function A(){I(c,k)}function Y(){L(),o.style.display="block",document.addEventListener("keydown",g)}function T(){o.style.display="none",document.removeEventListener("keydown",g)}function S(){let y=document.querySelector(".projects__list-wrapper").querySelectorAll(".project__title");n.innerHTML="",y.forEach(h=>{let E=document.createElement("li");E.classList.add("popup-project__item");let tt=document.createElement("span");tt.textContent=h.textContent.trim(),E.appendChild(tt),n.appendChild(E),E.addEventListener("click",function(){let B=E.textContent.trim();l.value=B,A()})}),M()}function M(){document.querySelectorAll(".popup-project__list li").length===0?p.style.display="block":p.style.display="none"}document.addEventListener("click",function(u){!r.contains(u.target)&&u.target!==s&&v(),!c.contains(u.target)&&u.target!==l&&A(),!o.contains(u.target)&&u.target!==e&&T()})}function J(t,e){localStorage.setItem(t,JSON.stringify(e))}function b(t){let e=localStorage.getItem(t);return e?JSON.parse(e):[]}function Mt(t){let e=b("tasks");e.push(t),J("tasks",e)}function Pt(t){let e=b("projects");e.push(t),J("projects",e)}function Nt(t){return b("tasks").some(o=>o.id===t)}function Ft(t,e,o=null){document.querySelectorAll(t).forEach(r=>{r.addEventListener("click",()=>{let a=r.closest(e);if(a)if(o){let i=a.dataset.id;document.querySelectorAll(`${e}[${o}="${i}"]`).forEach(c=>{c.remove()}),Bt(i,!0)}else a.remove(),Bt(a.dataset.id,!1)})})}function Bt(t,e){let s=(e?b("tasks"):b("projects")).filter(r=>r.id!==t);e?J("tasks",s):J("projects",s)}function ue(t,e,o,s,r,a){let l=b("tasks").map(c=>c.id===t?{...c,title:e,description:o,date:s,priority:r,project:a}:c);localStorage.setItem("tasks",JSON.stringify(l))}function pe(t,e,o){let r=b("projects").map(a=>a.id===t?{...a,title:e,description:o}:a);localStorage.setItem("projects",JSON.stringify(r))}function Ot(t,e,o,s,r,a){let i=document.querySelectorAll(t),l=document.querySelector(o);i.forEach(c=>{c.addEventListener("click",()=>{let n=c.closest(e);if(n.classList.add(`${e.slice(1)}--edit`),n){let d=n.dataset.id,p=n.querySelector(s).textContent.trim(),C=n.querySelector(r).textContent.trim(),m=l.content.cloneNode(!0).querySelector(".task-editor"),_=m.querySelector('[name="title_task"]'),k=m.querySelector('[name="discription_task"]'),g=m.querySelector('[name="data_task"]'),L=m.querySelector('[name="priority_task"]'),D=m.querySelector('[name="project_task"]'),I=m.querySelector(".task-editor__priority-label"),f=m.querySelector(".task-editor__submit-btn"),v=document.createElement("span"),N=document.createElement("span");_.value=p,k.value=C,v.classList.add("task-editor__error"),N.classList.add("task-editor__error"),_.parentNode.appendChild(v),k.parentNode.appendChild(N),_.addEventListener("input",()=>{w(_,$,v,x.TITLE,f),P(_,k,f)}),k.addEventListener("input",()=>{w(k,V,N,x.DISC,f),P(_,k,f)}),P(_,k,f),f.querySelector("use").setAttribute("href","icons/stack.svg#checkmark"),f.addEventListener("click",()=>{if(w(_,$,v,x.TITLE,f),w(k,V,N,x.DISC,f),_.classList.contains("has-error")||k.classList.contains("has-error"))return;let S=_.value.trim(),M=k.value.trim();if(n.querySelector(s).textContent=S,n.querySelector(r).textContent=M,a){let y=g.value.trim(),h=L.value.trim(),E=D.value.trim();document.querySelectorAll(`.task[data-id="${d}"]`).forEach(B=>{B.querySelector(".task__title").textContent=S,B.querySelector(".task__discription").textContent=M,B.querySelector(".task__data").textContent=y,B.querySelector(".task__project").textContent=E,B.dataset.project=E;let G=B.querySelector(".task__circle");G.classList.remove("task__circle--priority1","task__circle--priority2","task__circle--priority3"),h==="\u0421\u0440\u043E\u0447\u043D\u043E"?G.classList.add("task__circle--priority1"):h==="\u0412\u0430\u0436\u043D\u043E"?G.classList.add("task__circle--priority2"):h==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&G.classList.add("task__circle--priority3")}),ue(d,S,M,y,h,E)}else{let y=_.value.trim(),h=k.value.trim();pe(d,y,h)}m.classList.add("task-editor--hidden"),m.addEventListener("transitionend",function y(){n.classList.remove(`${e.slice(1)}--edit`),m.remove(),m.removeEventListener("transitionend",y)},{once:!0}),j(),U();let u=document.querySelector(".tasks__header-button--active");if(u){let y=u.textContent.trim();O(y)}});let Y=n.closest(".list, .projects__list").querySelector(".manager-item");Y.innerHTML="",Y.appendChild(m),m.classList.add("task-editor--visible");let T=m.querySelector(".task-editor__close-btn");if(T&&T.addEventListener("click",()=>{m.classList.add("task-editor--hidden"),m.addEventListener("transitionend",function S(){n.classList.remove(`${e.slice(1)}--edit`),m.remove(),m.removeEventListener("transitionend",S)},{once:!0})}),a){let S=n.querySelector(".task__data").textContent.trim(),M=n.querySelector(".task__project").textContent.trim(),u=n.querySelector(".task__circle").classList.contains("task__circle--priority1")?"\u0421\u0440\u043E\u0447\u043D\u043E":n.querySelector(".task__circle").classList.contains("task__circle--priority2")?"\u0412\u0430\u0436\u043D\u043E":n.querySelector(".task__circle").classList.contains("task__circle--priority3")?"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":"";g.value=S,D.value=M,L.value=u,u==="\u0421\u0440\u043E\u0447\u043D\u043E"?I.classList.add("task-editor__priority-label--priority1"):u==="\u0412\u0430\u0436\u043D\u043E"?I.classList.add("task-editor__priority-label--priority2"):u==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&I.classList.add("task-editor__priority-label--priority3"),R(S)}z()}})})}function yt(){Ft(".button-delete-task",".task","data-id")}function Yt(){Ft(".button-delete-project",".project")}function kt(){Ot(".button-edit-task",".task","#task-editor",".task__title",".task__discription",!0)}function Ht(){Ot(".button-edit-project",".project","#project-editor",".project__title",".project__discription",!1)}function _t(t){let e=document.querySelector(".projects"),o=document.querySelector(".projects-task"),s=document.querySelector(".app-header__title"),r=t.target.closest(".project").querySelector(".project__title").textContent,a=document.querySelectorAll(".list-with-tasks__wrapper .task");me(),document.querySelectorAll(`.list-with-tasks__wrapper .task[data-project="${r}"]`).forEach(n=>{n.classList.remove("task--hidden")}),a.forEach(n=>{(n.classList.contains("task--expired")||n.classList.contains("task--completed"))&&n.classList.add("task--hidden")}),e.style.display="none",o.style.display="block",o.dataset.project=r;let l="\u041F\u0440\u043E\u0435\u043A\u0442\u044B / "+r.slice(0,20)+(r.length>17?"...":"");s.textContent=l,document.querySelector(".button-back").classList.remove("tasks__header-button--active")}function ft(){let t=document.querySelector(".projects"),e=document.querySelector(".projects-task"),o=document.querySelector(".app-header__title"),s=document.querySelectorAll(".project__title");document.querySelectorAll(".manager-item").forEach(i=>{i.innerHTML=""}),H.forEach(i=>{i.classList.remove("new-item--disabled")}),e.style.display="none",t.style.display="block";let a=o.textContent;s.forEach((i,l)=>{let c=i.textContent,n=c.slice(0,20)+(c.length>17?"...":"");l===0?(a=a.replace("/ "+c,""),a=a.replace("/ "+n,"")):a.includes(" / "+c)&&(a=a.replace(" / "+c,""),a=a.replace(" / "+n,""))}),o.textContent=a}function me(){let t=event.target.closest(".project").querySelector(".project__title").textContent;document.querySelectorAll(".list-with-tasks__wrapper .task").forEach(s=>{s.classList.add("task--hidden")}),document.querySelectorAll(`.list-with-tasks__wrapper .task[data-project="${t}"]`).forEach(s=>{s.classList.remove("task--hidden")})}var $t=document.querySelector("#task"),Vt=document.querySelector("#project"),ye=document.querySelector("#project-editor"),ke=document.querySelector("#task-editor"),Wt=document.querySelectorAll(".list-with-tasks"),Ut=document.querySelectorAll(".projects__list");document.addEventListener("DOMContentLoaded",()=>{b("tasks").forEach(r=>{let a=pt();Wt.forEach(i=>{let c=$t.content.cloneNode(!0).querySelector(".task");c.dataset.id=r.id,c.dataset.order=a,c.dataset.project=r.project,c.querySelector(".task__title").textContent=r.title,c.querySelector(".task__discription").textContent=r.description,c.querySelector(".task__data").textContent=r.date||"\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430",c.querySelector(".task__project").textContent=r.project;let n=c.querySelector(".task__circle");r.priority==="\u0421\u0440\u043E\u0447\u043D\u043E"?n.classList.add("task__circle--priority1"):r.priority==="\u0412\u0430\u0436\u043D\u043E"?n.classList.add("task__circle--priority2"):r.priority==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&n.classList.add("task__circle--priority3"),i.querySelector(".list-with-tasks__wrapper").appendChild(c),kt(),yt()})}),b("projects").forEach(r=>{Ut.forEach(a=>{let i=Vt.content.cloneNode(!0),l=i.querySelector(".project__title"),c=i.querySelector(".project__discription");l.textContent=r.title,c.textContent=r.description,a.querySelector(".projects__list-wrapper").appendChild(i),Ht(),Yt()})}),document.querySelectorAll(".project__info-wrapper").forEach(r=>{r.addEventListener("click",_t)}),document.querySelector(".button-back").addEventListener("click",ft),lt(),j(),xt(),wt()});H.forEach(t=>{let e=t.querySelector(".new-item__task"),o=t.closest(".list"),s=o&&o.classList.contains("projects__list");e.addEventListener("click",()=>{let a=(s?ye:ke).content.cloneNode(!0),i=a.querySelector(".task-editor");if(i&&o){let c=o.querySelector(".manager-item");if(c){c.innerHTML="",c.appendChild(a),i.classList.add("task-editor--visible"),t.classList.add("new-item--disabled");let n=i.querySelector('[name="title_task"]'),d=i.querySelector('[name="discription_task"]'),p=i.querySelector(".task-editor__submit-btn"),C=document.createElement("span"),m=document.createElement("span");C.classList.add("task-editor__error"),m.classList.add("task-editor__error"),n.parentNode.appendChild(C),d.parentNode.appendChild(m),n.addEventListener("input",()=>{w(n,$,C,x.TITLE,p),P(n,d,p)}),d.addEventListener("input",()=>{w(d,V,m,x.DISC,p),P(n,d,p)}),P(n,d,p),p.addEventListener("click",()=>{if(w(n,$,C,x.TITLE,p),w(d,V,m,x.DISC,p),n.classList.contains("has-error")||d.classList.contains("has-error"))return;let _=n.value,k=d.value;if(s){let L={title:_,description:k};Ut.forEach(f=>{let v=Vt.content.cloneNode(!0);v.querySelector(".project__title").textContent=_,v.querySelector(".project__discription").textContent=k,f.querySelector(".projects__list-wrapper").appendChild(v)}),Pt(L),document.querySelectorAll(".project__info-wrapper").forEach(f=>{f.addEventListener("click",_t)}),document.querySelector(".button-back").addEventListener("click",ft)}else{let L=Dt(),D=pt();Wt.forEach(I=>{let f=$t.content.cloneNode(!0),v=f.querySelector(".task");v.dataset.id=L,v.dataset.order=D;let N=f.querySelector(".task__title"),A=f.querySelector(".task__discription"),Y=f.querySelector(".task__data"),T=f.querySelector(".task__project"),S=f.querySelector(".task__circle"),M=document.querySelector(".task-editor__priority-label"),u=i.querySelector('[name="data_task"]').value,y=i.querySelector('[name="priority_task"]').value,h=i.querySelector('[name="project_task"]').value;N.textContent=_,A.textContent=k,Y.textContent=u,u||(Y.textContent="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"),T.textContent=h,v.dataset.project=h,y==="\u0421\u0440\u043E\u0447\u043D\u043E"?S.classList.add("task__circle--priority1"):y==="\u0412\u0430\u0436\u043D\u043E"?S.classList.add("task__circle--priority2"):y==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&S.classList.add("task__circle--priority3"),M.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),I.querySelector(".list-with-tasks__wrapper").appendChild(f),kt(),yt(),Nt(L)||Mt({id:L,order:D,title:_,description:k,date:u,priority:y,project:h})})}i.reset(),P(n,d,p),j(),U();let g=document.querySelector(".tasks__header-button--active");if(g){let L=g.textContent.trim();O(L)}lt()}),s||R(It()),z()}}let l=i.querySelector(".task-editor__close-btn");l&&l.addEventListener("click",()=>{i.classList.add("task-editor--hidden"),i.addEventListener("transitionend",function c(){i.remove(),t.classList.remove("new-item--disabled"),i.removeEventListener("transitionend",c)},{once:!0})})})});var ht=document.querySelector(".dashboard .list-with-tasks__wrapper"),Q=document.querySelector(".tasks .list-with-tasks__wrapper"),Z=document.querySelector(".projects-task .list-with-tasks__wrapper"),Jt=document.querySelector(".dashboard__select-control");Jt.addEventListener("change",function(){let t=Jt.value;t==="priority"?vt(ht):t==="name"?Lt(ht):St(ht)});var Gt=document.querySelector(".tasks__select-control");Gt.addEventListener("change",function(){let t=Gt.value;t==="priority"?vt(Q):t==="name"?Lt(Q):t==="date"?zt(Q):St(Q)});var Xt=document.querySelector(".projects-task-control");Xt.addEventListener("change",function(){let t=Xt.value;t==="priority"?vt(Z):t==="name"?Lt(Z):t==="date"?zt(Z):St(Z)});function vt(t){let e=Array.from(t.querySelectorAll("li"));e.sort((o,s)=>{let r=Kt(o.querySelector(".task__circle")),a=Kt(s.querySelector(".task__circle"));return r-a}),e.forEach(o=>t.appendChild(o))}function Lt(t){let e=Array.from(t.querySelectorAll("li"));e.sort((o,s)=>{let r=o.querySelector(".task__title").textContent.toLowerCase(),a=s.querySelector(".task__title").textContent.toLowerCase();return r.localeCompare(a)}),e.forEach(o=>t.appendChild(o))}function St(t){let e=Array.from(t.querySelectorAll("li"));e.sort((o,s)=>{let r=parseInt(o.dataset.order),a=parseInt(s.dataset.order);return r-a}),e.forEach(o=>t.appendChild(o))}function zt(t){let e=Array.from(t.querySelectorAll("li"));e.sort((o,s)=>{let r=mt(o.querySelector(".task__data").textContent),a=mt(s.querySelector(".task__data").textContent);return r-a}),e.forEach(o=>t.appendChild(o))}function Kt(t){let e={"task__circle--priority1":1,"task__circle--priority2":2,"task__circle--priority3":3,task__circle:4},o=Array.from(t.classList).find(s=>s.startsWith("task__circle--priority"));return o?e[o]:e.task__circle}var gt=document.getElementById("myVideo"),Et=document.getElementById("playPause");Et.addEventListener("click",function(){gt.paused?(gt.play(),Et.textContent="Pause"):(gt.pause(),Et.textContent="Play")});
