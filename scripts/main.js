var B=n=>n.key==="Escape",D=n=>t=>{B(t)&&(t.preventDefault(),n())};function M(){let n=new Date,t={rendered:!1,localDate:new Date,prevMonthLastDate:null,calWeekDays:["\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431","\u0412\u0441"],calMonthName:["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0440\u0432\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],daysInMonth:function(e,o){return new Date(o,e,0).getDate()},firstDay:function(){return new Date(n.getFullYear(),n.getMonth(),1)},lastDay:function(){return new Date(n.getFullYear(),n.getMonth()+1,0)},firstDayNumber:function(){let e=t.firstDay().getDay();return e===0?7:e},lastDayNumber:function(){return t.lastDay().getDay()+1},getPreviousMonthLastDate:function(){return new Date(n.getFullYear(),n.getMonth(),0).getDate()},navigateToPreviousMonth:function(){n.setMonth(n.getMonth()-1),t.attachEventsOnNextPrev()},navigateToNextMonth:function(){n.setMonth(n.getMonth()+1),t.attachEventsOnNextPrev()},navigateToCurrentMonth:function(){let e=t.localDate.getMonth(),o=t.localDate.getFullYear();n.setMonth(e),n.setYear(o),t.attachEventsOnNextPrev()},displayYear:function(){let e=document.querySelector(".calendar .calendar-year-label");e.innerHTML=n.getFullYear()},displayMonth:function(){let e=document.querySelector(".calendar .calendar-month-label");e.innerHTML=t.calMonthName[n.getMonth()]},plotSelectors:function(){let e=document.querySelector(".calendar"),o=document.createElement("div");o.classList.add("calendar-inner");let a=document.createElement("div");a.classList.add("calendar-controls");let r=document.createElement("div");r.classList.add("calendar-prev");let d=document.createElement("a");d.setAttribute("href","#");let l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("width","128"),l.setAttribute("height","128"),l.setAttribute("viewBox","0 0 128 128");let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("fill","#666"),c.setAttribute("d","M88.2 3.8L35.8 56.23 28 64l7.8 7.78 52.4 52.4 9.78-7.76L45.58 64l52.4-52.4z"),l.appendChild(c),d.appendChild(l),r.appendChild(d);let i=document.createElement("div");i.classList.add("calendar-year-month");let S=document.createElement("div");S.classList.add("calendar-month-label");let f=document.createElement("div");f.textContent="-";let g=document.createElement("div");g.classList.add("calendar-year-label"),i.appendChild(S),i.appendChild(f),i.appendChild(g);let h=document.createElement("div");h.classList.add("calendar-next");let y=document.createElement("a");y.setAttribute("href","#");let p=document.createElementNS("http://www.w3.org/2000/svg","svg");p.setAttribute("xmlns","http://www.w3.org/2000/svg"),p.setAttribute("width","128"),p.setAttribute("height","128"),p.setAttribute("viewBox","0 0 128 128");let v=document.createElementNS("http://www.w3.org/2000/svg","path");v.setAttribute("fill","#666"),v.setAttribute("d","M38.8 124.2l52.4-52.42L99 64l-7.77-7.78-52.4-52.4-9.8 7.77L81.44 64 29 116.42z"),p.appendChild(v),y.appendChild(p),h.appendChild(y),a.appendChild(r),a.appendChild(i),a.appendChild(h);let L=document.createElement("div");L.classList.add("calendar-body"),o.appendChild(a),o.appendChild(L),e.appendChild(o)},plotDayNames:function(){let e=document.querySelector(".calendar .calendar-body");t.calWeekDays.forEach(o=>{let a=document.createElement("div");a.textContent=o,e.appendChild(a)})},plotDates:function(){let e=document.querySelector(".calendar .calendar-body");t.rendered||(t.plotSelectors(),t.rendered=!0),e.innerHTML="",t.plotDayNames(),t.displayMonth(),t.displayYear();let o=1,a=0;t.prevMonthLastDate=t.getPreviousMonthLastDate();let r=[],d=t.daysInMonth(n.getMonth()+1,n.getFullYear());for(let l=1;l<d;l++)if(l<t.firstDayNumber()){a+=1;let c=document.createElement("div");c.classList.add("prev-dates"),e.appendChild(c),r.push(t.prevMonthLastDate--)}else{let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",o);let i=document.createElement("a");i.classList.add("dateNumber"),i.href="#",i.textContent=o++,c.appendChild(i),e.appendChild(c)}for(let l=0;l<a+1;l++){let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",o);let i=document.createElement("a");i.classList.add("dateNumber"),i.href="#",i.textContent=o++,c.appendChild(i),e.appendChild(c)}t.highlightToday(),t.plotPrevMonthDates(r),t.plotNextMonthDates()},attachEvents:function(){let e=document.querySelector(".calendar .calendar-prev a"),o=document.querySelector(".calendar .calendar-next a"),a=document.querySelectorAll(".calendar .dateNumber");e.addEventListener("click",t.navigateToPreviousMonth),o.addEventListener("click",t.navigateToNextMonth);for(var r=0;r<a.length;r++)a[r].addEventListener("click",t.selectDate,!1)},highlightToday:function(){let e=t.localDate.getMonth()+1,o=n.getMonth()+1,a=t.localDate.getFullYear(),r=n.getFullYear();a===r&&e===o&&document.querySelectorAll(".number-item")&&document.querySelectorAll(".number-item")[n.getDate()-1].classList.add("calendar-today")},plotPrevMonthDates:function(e){e.reverse();for(let o=0;o<e.length;o++)document.querySelectorAll(".prev-dates")&&(document.querySelectorAll(".prev-dates")[o].textContent=e[o])},plotNextMonthDates:function(){let e=document.querySelector(".calendar-body").childElementCount;if(e>42){let o=49-e;t.loopThroughNextDays(o)}if(e>35&&e<=42){let o=42-e;t.loopThroughNextDays(42-e)}},loopThroughNextDays:function(e){let o=document.querySelector(".calendar-body");if(e>0)for(let a=1;a<=e;a++){let r=document.createElement("div");r.classList.add("next-dates"),r.textContent=a,o.appendChild(r)}},attachEventsOnNextPrev:function(){t.plotDates(),t.attachEvents()},init:function(){t.rendered||(t.plotSelectors(),t.rendered=!0),t.plotDates(),t.attachEvents()}};t.init()}function q(){let n=document.querySelectorAll(".editor"),t=document.getElementById("dateInput"),e=document.querySelector(".calendar"),o=document.getElementById("priorityInput"),a=document.querySelector(".task-editor__priority-label"),r=document.querySelector(".popup-priority"),d=document.querySelectorAll(".popup-priority__item"),l=document.getElementById("projectInput"),c=document.querySelector(".popup-project"),i=document.querySelectorAll(".popup-project__item"),S=new M;n.forEach(s=>{s.addEventListener("input",()=>{s.style.height="auto",s.style.height=s.scrollHeight+"px"})});function f(s,u,C){return function(T){T.stopPropagation(),s.classList.contains("task-editor__popup--open")?C():u()}}o.addEventListener("click",f(r,P,b)),l.addEventListener("click",f(c,N,E)),d.forEach(function(s){s.addEventListener("click",function(){let u=s.textContent.trim();switch(o.value=u,a.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),u){case"\u0421\u0440\u043E\u0447\u043D\u043E":a.classList.add("task-editor__priority-label--priority1");break;case"\u0412\u0430\u0436\u043D\u043E":a.classList.add("task-editor__priority-label--priority2");break;case"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":a.classList.add("task-editor__priority-label--priority3");break;default:break}b()})}),i.forEach(function(s){s.addEventListener("click",function(){let u=s.textContent.trim();l.value=u,E()})}),t.addEventListener("click",()=>{e.style.display==="block"?w():I()}),e.addEventListener("click",function(s){if(s.target.classList.contains("dateNumber")){let u=s.target.textContent.trim(),C=e.querySelector(".calendar-month-label").textContent.trim();t.value=`${u} ${C}`,w()}});let g=D(b),h=D(E),y=D(w);function p(){w(),b(),E()}function v(s,u){p(),s.classList.add("task-editor__popup--open"),document.addEventListener("keydown",u)}function L(s,u){s.classList.remove("task-editor__popup--open"),document.removeEventListener("keydown",u)}function P(){v(r,g)}function b(){L(r,g)}function N(){v(c,h)}function E(){L(c,h)}function I(){p(),e.style.display="block",document.addEventListener("keydown",y)}function w(){e.style.display="none",document.removeEventListener("keydown",y)}document.addEventListener("click",function(s){!r.contains(s.target)&&s.target!==o&&b(),!c.contains(s.target)&&s.target!==l&&E(),!e.contains(s.target)&&s.target!==t&&w()})}var m=document.querySelector(".sidebar"),k=document.querySelectorAll(".new-item");var Y=document.querySelector("#task-editor"),j=document.querySelector("#project-editor");k.forEach(n=>{let t=n.querySelector(".new-item__task"),e=n.closest(".list"),o=e&&e.classList.contains("projects__list");t.addEventListener("click",()=>{let r=(o?j:Y).content.cloneNode(!0),d=r.querySelector(".task-editor");if(d&&e){let c=e.querySelector(".manager-item");c&&(c.innerHTML="",c.appendChild(r),d.classList.add("task-editor--visible"),n.classList.add("new-item--disabled"),o||q())}let l=d.querySelector(".task-editor__close-btn");l&&l.addEventListener("click",()=>{d.classList.add("task-editor--hidden"),d.addEventListener("transitionend",function c(){d.remove(),n.classList.remove("new-item--disabled"),d.removeEventListener("transitionend",c)},{once:!0})})})});var F=document.querySelectorAll(".nav__item a"),H=document.querySelectorAll(".nav__link"),O=document.querySelector(".app-header__title"),K=document.querySelectorAll(".manager-item");F.forEach(n=>{n.addEventListener("click",t=>{t.preventDefault(),K.forEach(l=>{l.innerHTML=""}),k.forEach(l=>{l.classList.remove("new-item--disabled")}),H.forEach(l=>{l.classList.remove("nav__link--active")}),n.classList.add("nav__link--active"),m.classList.remove("sidebar--open");let e=n.textContent;O.textContent=e;let o=n.getAttribute("data-section"),a=document.querySelectorAll(".section");for(var r=0;r<a.length;r++)a[r].style.display="none";let d=document.getElementById(o);d&&(d.style.display="block")})});var x=document.querySelector(".sidebar__button"),_=document.querySelector(".dropdown-menu"),z=document.querySelector(".dropdown-menu__item--arrow"),U=document.querySelector(".dropdown-menu__submenu"),A=document.querySelector(".sidebar__user-button");x.addEventListener("click",()=>{m.classList.toggle("sidebar--open"),document.body.style.overflow=m.classList.contains("sidebar--open")?"hidden":"auto"});A.addEventListener("click",()=>{_.classList.toggle("dropdown-menu--open")});z.addEventListener("click",()=>{U.classList.toggle("dropdown-menu__submenu--open")});document.addEventListener("click",n=>{!m.contains(n.target)&&!x.contains(n.target)&&(m.classList.remove("sidebar--open"),document.body.style.overflow=m.classList.contains("sidebar--open")?"hidden":"auto"),!_.contains(n.target)&&!A.contains(n.target)&&_.classList.remove("dropdown-menu--open")});
