var At=e=>e.key==="Escape",J=e=>t=>{At(t)&&(t.preventDefault(),e())};function mt(){return Math.random().toString(36).substr(2,9)}var Q=function(){let e=0;return function(){return e++,e}}(),yt=()=>{let e=new Date,t=e.getDate(),o=["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0432\u0440\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],s=e.getMonth(),n=o[s];return`${t} ${n}`};function C(e,t,o,s,n){e.value.trim().length>t?(o.textContent=s,e.classList.add("has-error"),n.disabled=!0):(o.textContent="",e.classList.remove("has-error"),n.disabled=!1)}function M(e,t,o){let s=e.value.trim()!=="",n=!e.classList.contains("has-error"),a=!t.classList.contains("has-error");o.disabled=!s||!n||!a}function kt(){let e=new Date,t={rendered:!1,localDate:new Date,prevMonthLastDate:null,calWeekDays:["\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431","\u0412\u0441"],calMonthName:["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0440\u0432\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],daysInMonth:function(o,s){return new Date(s,o,0).getDate()},firstDay:function(){return new Date(e.getFullYear(),e.getMonth(),1)},lastDay:function(){return new Date(e.getFullYear(),e.getMonth()+1,0)},firstDayNumber:function(){let o=t.firstDay().getDay();return o===0?7:o},lastDayNumber:function(){return t.lastDay().getDay()+1},getPreviousMonthLastDate:function(){return new Date(e.getFullYear(),e.getMonth(),0).getDate()},navigateToPreviousMonth:function(){e.setMonth(e.getMonth()-1),t.attachEventsOnNextPrev()},navigateToNextMonth:function(){e.setMonth(e.getMonth()+1),t.attachEventsOnNextPrev()},navigateToCurrentMonth:function(){let o=t.localDate.getMonth(),s=t.localDate.getFullYear();e.setMonth(o),e.setYear(s),t.attachEventsOnNextPrev()},displayYear:function(){let o=document.querySelector(".calendar .calendar-year-label");o.innerHTML=e.getFullYear()},displayMonth:function(){let o=document.querySelector(".calendar .calendar-month-label");o.innerHTML=t.calMonthName[e.getMonth()]},plotSelectors:function(){let o=document.querySelector(".calendar"),s=document.createElement("div");s.classList.add("calendar-inner");let n=document.createElement("div");n.classList.add("calendar-controls");let a=document.createElement("div");a.classList.add("calendar-prev");let i=document.createElement("a");i.setAttribute("href","#");let l=document.createElementNS("http://www.w3.org/2000/svg","svg");l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("width","128"),l.setAttribute("height","128"),l.setAttribute("viewBox","0 0 128 128");let c=document.createElementNS("http://www.w3.org/2000/svg","path");c.setAttribute("fill","#666"),c.setAttribute("d","M88.2 3.8L35.8 56.23 28 64l7.8 7.78 52.4 52.4 9.78-7.76L45.58 64l52.4-52.4z"),l.appendChild(c),i.appendChild(l),a.appendChild(i);let r=document.createElement("div");r.classList.add("calendar-year-month");let y=document.createElement("div");y.classList.add("calendar-month-label");let p=document.createElement("div");p.textContent="-";let x=document.createElement("div");x.classList.add("calendar-year-label"),r.appendChild(y),r.appendChild(p),r.appendChild(x);let u=document.createElement("div");u.classList.add("calendar-next");let f=document.createElement("a");f.setAttribute("href","#");let k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.setAttribute("xmlns","http://www.w3.org/2000/svg"),k.setAttribute("width","128"),k.setAttribute("height","128"),k.setAttribute("viewBox","0 0 128 128");let g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("fill","#666"),g.setAttribute("d","M38.8 124.2l52.4-52.42L99 64l-7.77-7.78-52.4-52.4-9.8 7.77L81.44 64 29 116.42z"),k.appendChild(g),f.appendChild(k),u.appendChild(f),n.appendChild(a),n.appendChild(r),n.appendChild(u);let L=document.createElement("div");L.classList.add("calendar-body"),s.appendChild(n),s.appendChild(L),o.appendChild(s)},plotDayNames:function(){let o=document.querySelector(".calendar .calendar-body");t.calWeekDays.forEach(s=>{let n=document.createElement("div");n.textContent=s,o.appendChild(n)})},plotDates:function(){let o=document.querySelector(".calendar .calendar-body");t.rendered||(t.plotSelectors(),t.rendered=!0),o.innerHTML="",t.plotDayNames(),t.displayMonth(),t.displayYear();let s=1,n=0;t.prevMonthLastDate=t.getPreviousMonthLastDate();let a=[],i=t.daysInMonth(e.getMonth()+1,e.getFullYear());for(let l=1;l<i;l++)if(l<t.firstDayNumber()){n+=1;let c=document.createElement("div");c.classList.add("prev-dates"),o.appendChild(c),a.push(t.prevMonthLastDate--)}else{let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",s);let r=document.createElement("a");r.classList.add("dateNumber"),r.href="#",r.textContent=s++,c.appendChild(r),o.appendChild(c)}for(let l=0;l<n+1;l++){let c=document.createElement("div");c.classList.add("number-item"),c.setAttribute("data-num",s);let r=document.createElement("a");r.classList.add("dateNumber"),r.href="#",r.textContent=s++,c.appendChild(r),o.appendChild(c)}t.highlightToday(),t.plotPrevMonthDates(a),t.plotNextMonthDates()},attachEvents:function(){let o=document.querySelector(".calendar .calendar-prev a"),s=document.querySelector(".calendar .calendar-next a"),n=document.querySelectorAll(".calendar .dateNumber");o.addEventListener("click",t.navigateToPreviousMonth),s.addEventListener("click",t.navigateToNextMonth);for(var a=0;a<n.length;a++)n[a].addEventListener("click",t.selectDate,!1)},highlightToday:function(){let o=t.localDate.getMonth()+1,s=e.getMonth()+1,n=t.localDate.getFullYear(),a=e.getFullYear();n===a&&o===s&&document.querySelectorAll(".number-item")&&document.querySelectorAll(".number-item")[e.getDate()-1].classList.add("calendar-today")},plotPrevMonthDates:function(o){o.reverse();for(let s=0;s<o.length;s++)document.querySelectorAll(".prev-dates")&&(document.querySelectorAll(".prev-dates")[s].textContent=o[s])},plotNextMonthDates:function(){let o=document.querySelector(".calendar-body").childElementCount;if(o>42){let s=49-o;t.loopThroughNextDays(s)}if(o>35&&o<=42){let s=42-o;t.loopThroughNextDays(42-o)}},loopThroughNextDays:function(o){let s=document.querySelector(".calendar-body");if(o>0)for(let n=1;n<=o;n++){let a=document.createElement("div");a.classList.add("next-dates"),a.textContent=n,s.appendChild(a)}},attachEventsOnNextPrev:function(){t.plotDates(),t.attachEvents()},init:function(){t.rendered||(t.plotSelectors(),t.rendered=!0),t.plotDates(),t.attachEvents()}};t.init()}function G(){document.querySelectorAll(".editor").forEach(t=>{t.addEventListener("input",()=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"})})}function X(e){let t=document.getElementById("dateInput"),o=document.querySelector(".calendar"),s=document.getElementById("priorityInput"),n=document.querySelector(".popup-priority"),a=document.querySelectorAll(".popup-priority__item"),i=document.querySelector(".task-editor__priority-label"),l=document.getElementById("projectInput"),c=document.querySelector(".popup-project"),r=document.querySelector(".popup-project__list"),y=document.querySelector(".popup-project_btn-reset"),p=document.querySelector(".popup-project__list-empty"),x=new kt;function u(d,m,_){return function(E){E.stopPropagation(),d.classList.contains("task-editor__popup--open")?_():m()}}if(s.addEventListener("click",u(n,h,v)),!l.closest(".list-in-project"))l.addEventListener("click",u(c,N,I));else{let d=document.querySelector(".projects-task").dataset.project;l.value=d}y.addEventListener("click",()=>{l.value="";let m=document.querySelector(".task-editor").dataset.taskId,_=document.querySelector(`.task[data-id="${m}"]`);_&&delete _.dataset.project,I()}),a.forEach(function(d){d.addEventListener("click",function(){let m=d.textContent.trim();switch(s.value=m,i.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),m){case"\u0421\u0440\u043E\u0447\u043D\u043E":i.classList.add("task-editor__priority-label--priority1");break;case"\u0412\u0430\u0436\u043D\u043E":i.classList.add("task-editor__priority-label--priority2");break;case"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":i.classList.add("task-editor__priority-label--priority3");break;default:break}v()})}),t.value=e,t.addEventListener("click",()=>{o.style.display==="block"?b():F()}),o.addEventListener("click",function(d){if(d.target.classList.contains("dateNumber")){let m=d.target.textContent.trim(),_=o.querySelector(".calendar-month-label").textContent.trim();t.value=`${m} ${_}`,b()}});let f=J(v),k=J(I),g=J(b);function L(){b(),v(),I()}function D(d,m){L(),d.classList.add("task-editor__popup--open"),document.addEventListener("keydown",m)}function w(d,m){d.classList.remove("task-editor__popup--open"),document.removeEventListener("keydown",m)}function h(){D(n,f)}function v(){w(n,f)}function N(){D(c,k),S()}function I(){w(c,k)}function F(){L(),o.style.display="block",document.addEventListener("keydown",g)}function b(){o.style.display="none",document.removeEventListener("keydown",g)}function S(){let m=document.querySelector(".projects__list-wrapper").querySelectorAll(".project__title");r.innerHTML="",m.forEach(_=>{let E=document.createElement("li");E.classList.add("popup-project__item");let R=document.createElement("span");R.textContent=_.textContent.trim(),E.appendChild(R),r.appendChild(E),E.addEventListener("click",function(){let P=E.textContent.trim();l.value=P,I()})}),A()}function A(){document.querySelectorAll(".popup-project__list li").length===0?p.style.display="block":p.style.display="none"}document.addEventListener("click",function(d){!n.contains(d.target)&&d.target!==s&&v(),!c.contains(d.target)&&d.target!==l&&I(),!o.contains(d.target)&&d.target!==t&&b()})}var zt=document.querySelector(".sidebar"),K=document.querySelectorAll(".new-item"),Y=100,O=500,j={TITLE:"\u0414\u043B\u0438\u043D\u0430 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0430 \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 100 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432.",DISC:"\u0414\u043B\u0438\u043D\u0430 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u044F \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 500 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432."};var ot=document.querySelector(".button-date"),Z=ot.querySelector(".button-date__title"),tt=ot.querySelector(".button-date__arrow--left"),et=ot.querySelector(".button-date__arrow--right"),Mt=document.querySelector(".dashboard .list-with-tasks__wrapper"),q=new Date;st();B();et.addEventListener("click",function(){et.classList.contains("button-date__arrow--disabled")||(q.setDate(q.getDate()+1),st(),B())});tt.addEventListener("click",function(){tt.classList.contains("button-date__arrow--disabled")||(q.setDate(q.getDate()-1),st(),B())});function st(){let e=new Date,t=new Date(e);t.setDate(t.getDate()+1),z(q,e)?Z.textContent="\u0421\u0435\u0433\u043E\u0434\u043D\u044F":z(q,t)?Z.textContent="\u0417\u0430\u0432\u0442\u0440\u0430":Z.textContent=Pt(q),Nt()}function Nt(){let e=new Date,t="button-date__arrow--disabled";tt.classList.toggle(t,z(q,e)),et.classList.toggle(t,Bt(q,e))}function B(){let e=Mt.querySelectorAll(".task"),t=/(\d+)\s+(\S+)/;e.forEach(o=>{let s=o.querySelector(".task__data").textContent;if(s.trim()==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){o.classList.add("task--hidden");return}if(o.classList.contains("task--completed")){o.classList.add("task--hidden");return}let[,n,a]=s.match(t),i=new Date(q.getFullYear(),rt(a),parseInt(n));z(q,i)?o.classList.remove("task--hidden"):o.classList.add("task--hidden")})}function Pt(e){let t={weekday:"long",month:"long",day:"numeric"};return e.toLocaleDateString("ru-RU",t)}function z(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}function Bt(e,t){let o=new Date(t.getFullYear(),t.getMonth(),t.getDate()+7);return e>=o}function rt(e){return["\u042F\u043D\u0432","\u0424\u0435\u0432","\u041C\u0430\u0440","\u0410\u043F\u0440","\u041C\u0430\u0439","\u0418\u044E\u043D","\u0418\u044E\u043B","\u0410\u0432\u0433","\u0421\u0435\u043D","\u041E\u043A\u0442","\u041D\u043E\u044F","\u0414\u0435\u043A"].indexOf(e)}var ft=document.querySelectorAll(".tasks__header-button"),ht=document.querySelector(".tasks .list-with-tasks__wrapper");ft.forEach(e=>{e.addEventListener("click",function(){ft.forEach(t=>t.classList.remove("tasks__header-button--active")),e.classList.add("tasks__header-button--active"),$(e.textContent.trim())})});function $(e){ht.querySelectorAll(".task").forEach(o=>{e==="\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0435"?o.classList.contains("task--completed")?o.classList.remove("task--hidden"):o.classList.add("task--hidden"):e==="\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0435"?o.classList.contains("task--completed")||o.classList.contains("task--expired")?o.classList.add("task--hidden"):o.classList.remove("task--hidden"):e==="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&(o.classList.contains("task--expired")?o.classList.remove("task--hidden"):o.classList.add("task--hidden"))})}function Ft(e){document.querySelectorAll(`.task[data-id="${e}"]`).forEach(o=>{vt(o)})}function _t(){nt().forEach(t=>{Ft(t)})}function H(e){localStorage.setItem("completedTasks",JSON.stringify(e))}function nt(){let e=localStorage.getItem("completedTasks");return e?JSON.parse(e):[]}function vt(e){let t=e.querySelector(".task__title"),o=e.dataset.id;e.classList.add("task--completed");let s=document.createElement("s");s.textContent=t.textContent,t.textContent="",t.appendChild(s),e.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#arrow-back");let a=nt(),i=it();i=i.filter(c=>c!==o),ct(i),a.push(o),H(a),a.includes(o)||(a.push(o),H(a)),a.push(o),H(a),e.style.transition="opacity 0.3s ease",e.style.opacity="0",setTimeout(()=>{e.classList.add("task--completed","task--hidden"),e.style.transition="",e.style.opacity=""},300),document.querySelectorAll('.list-with-tasks__wrapper .task[data-id="'+o+'"]').forEach(c=>{c.classList.add("task--completed");let r=c.querySelector(".task__title");if(!r.querySelector("s")){let p=document.createElement("s");p.textContent=r.textContent,r.textContent="",r.appendChild(p)}if(c.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#arrow-back"),c.classList.contains("task--expired")){c.classList.remove("task--expired");let p=c.querySelector(".task__info-expired");p&&p.remove()}})}function at(){document.querySelectorAll(".button-complete-task").forEach(t=>{t.addEventListener("click",function(o){let s=o.target.closest(".task");s.classList.contains("task--completed")?Yt(s):vt(s)})})}function Yt(e){let t=e.querySelector(".task__title s");t&&(t.parentNode.textContent=t.textContent),e.classList.remove("task--completed"),e.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#checkmark");let s=e.dataset.id,n=nt();n=n.filter(r=>r!==s),H(n);let a=it();a=a.filter(r=>r!==s),ct(a);let i=n.indexOf(s);i!==-1&&(n.splice(i,1),H(n)),n=n.filter(r=>r!==s),H(n),document.querySelectorAll('.list-with-tasks__wrapper .task[data-id="'+s+'"]').forEach(r=>{let y=r.querySelector(".task__title s");y&&(y.parentNode.textContent=y.textContent),r.classList.remove("task--completed"),r.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#checkmark")});let c=document.querySelector(".tasks__header-button--active");if(c){let r=c.textContent.trim();$(r)}U()}function Lt(){let e=it();document.querySelectorAll(".task").forEach(o=>{let s=o.dataset.id;e.includes(s)&&U()})}function ct(e){localStorage.setItem("expiredTasks",JSON.stringify(e))}function it(){let e=localStorage.getItem("expiredTasks");return e?JSON.parse(e):[]}function U(){let e=ht.querySelectorAll(".task"),t=new Date;t.setHours(0,0,0,0);let o=[];e.forEach(s=>{let n=s.dataset.id,a=s.querySelector(".task__data").textContent.trim();if(a==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){s.classList.add("task--hidden");return}let[,i,l]=a.match(/(\d+)\s+(\S+)/);if(new Date(t.getFullYear(),rt(l),parseInt(i)).getTime()<t.getTime()){s.classList.add("task--expired");let r=s.querySelector(".task__info-wrapper");if(!r.querySelector(".task__info-expired")){let p=document.createElement("span");p.classList.add("task__info-expired"),p.textContent="\u0417\u0430\u0434\u0430\u0447\u0430 \u043F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u0430",r.insertBefore(p,r.firstChild)}let y=document.querySelector(".tasks__header-button--active");y&&y.textContent!=="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&s.classList.add("task--hidden"),o.push(n)}else{s.classList.remove("task--expired");let r=s.querySelector(".task__info-expired");r&&r.remove()}}),ct(o)}function V(e,t){localStorage.setItem(e,JSON.stringify(t))}function T(e){let t=localStorage.getItem(e);return t?JSON.parse(t):[]}function St(e){let t=T("tasks");t.push(e),V("tasks",t)}function gt(e){let t=T("projects");t.push(e),V("projects",t)}function Et(e){return T("tasks").some(o=>o.id===e)}function Tt(e,t,o=null){document.querySelectorAll(e).forEach(n=>{n.addEventListener("click",()=>{let a=n.closest(t);if(a)if(o){let i=a.dataset.id;document.querySelectorAll(`${t}[${o}="${i}"]`).forEach(c=>{c.remove()}),qt(i,!0)}else a.remove(),qt(a.dataset.id,!1)})})}function qt(e,t){let s=(t?T("tasks"):T("projects")).filter(n=>n.id!==e);t?V("tasks",s):V("projects",s)}function Ot(e,t,o,s,n,a){let l=T("tasks").map(c=>c.id===e?{...c,title:t,description:o,date:s,priority:n,project:a}:c);localStorage.setItem("tasks",JSON.stringify(l))}function Ht(e,t,o){let n=T("projects").map(a=>a.id===e?{...a,title:t,description:o}:a);localStorage.setItem("projects",JSON.stringify(n))}function xt(e,t,o,s,n,a){let i=document.querySelectorAll(e),l=document.querySelector(o);i.forEach(c=>{c.addEventListener("click",()=>{let r=c.closest(t);if(r.classList.add(`${t.slice(1)}--edit`),r){let y=r.dataset.id,p=r.querySelector(s).textContent.trim(),x=r.querySelector(n).textContent.trim(),u=l.content.cloneNode(!0).querySelector(".task-editor"),f=u.querySelector('[name="title_task"]'),k=u.querySelector('[name="discription_task"]'),g=u.querySelector('[name="data_task"]'),L=u.querySelector('[name="priority_task"]'),D=u.querySelector('[name="project_task"]'),w=u.querySelector(".task-editor__priority-label"),h=u.querySelector(".task-editor__submit-btn"),v=document.createElement("span"),N=document.createElement("span");f.value=p,k.value=x,v.classList.add("task-editor__error"),N.classList.add("task-editor__error"),f.parentNode.appendChild(v),k.parentNode.appendChild(N),f.addEventListener("input",()=>{C(f,Y,v,j.TITLE,h),M(f,k,h)}),k.addEventListener("input",()=>{C(k,O,N,j.DISC,h),M(f,k,h)}),M(f,k,h),h.querySelector("use").setAttribute("href","icons/stack.svg#checkmark"),h.addEventListener("click",()=>{if(C(f,Y,v,j.TITLE,h),C(k,O,N,j.DISC,h),f.classList.contains("has-error")||k.classList.contains("has-error"))return;let S=f.value.trim(),A=k.value.trim();if(r.querySelector(s).textContent=S,r.querySelector(n).textContent=A,a){let m=g.value.trim(),_=L.value.trim(),E=D.value.trim();document.querySelectorAll(`.task[data-id="${y}"]`).forEach(P=>{P.querySelector(".task__title").textContent=S,P.querySelector(".task__discription").textContent=A,P.querySelector(".task__data").textContent=m,P.querySelector(".task__project").textContent=E,P.dataset.project=E;let W=P.querySelector(".task__circle");W.classList.remove("task__circle--priority1","task__circle--priority2","task__circle--priority3"),_==="\u0421\u0440\u043E\u0447\u043D\u043E"?W.classList.add("task__circle--priority1"):_==="\u0412\u0430\u0436\u043D\u043E"?W.classList.add("task__circle--priority2"):_==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&W.classList.add("task__circle--priority3")}),Ot(y,S,A,m,_,E)}else{let m=f.value.trim(),_=k.value.trim();Ht(y,m,_)}u.classList.add("task-editor--hidden"),u.addEventListener("transitionend",function m(){r.classList.remove(`${t.slice(1)}--edit`),u.remove(),u.removeEventListener("transitionend",m)},{once:!0}),B(),U();let d=document.querySelector(".tasks__header-button--active");if(d){let m=d.textContent.trim();$(m)}});let F=r.closest(".list, .projects__list").querySelector(".manager-item");F.innerHTML="",F.appendChild(u),u.classList.add("task-editor--visible");let b=u.querySelector(".task-editor__close-btn");if(b&&b.addEventListener("click",()=>{u.classList.add("task-editor--hidden"),u.addEventListener("transitionend",function S(){r.classList.remove(`${t.slice(1)}--edit`),u.remove(),u.removeEventListener("transitionend",S)},{once:!0})}),a){let S=r.querySelector(".task__data").textContent.trim(),A=r.querySelector(".task__project").textContent.trim(),d=r.querySelector(".task__circle").classList.contains("task__circle--priority1")?"\u0421\u0440\u043E\u0447\u043D\u043E":r.querySelector(".task__circle").classList.contains("task__circle--priority2")?"\u0412\u0430\u0436\u043D\u043E":r.querySelector(".task__circle").classList.contains("task__circle--priority3")?"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":"";g.value=S,D.value=A,L.value=d,d==="\u0421\u0440\u043E\u0447\u043D\u043E"?w.classList.add("task-editor__priority-label--priority1"):d==="\u0412\u0430\u0436\u043D\u043E"?w.classList.add("task-editor__priority-label--priority2"):d==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&w.classList.add("task-editor__priority-label--priority3"),X(S)}G()}})})}function lt(){Tt(".button-delete-task",".task","data-id")}function bt(){Tt(".button-delete-project",".project")}function dt(){xt(".button-edit-task",".task","#task-editor",".task__title",".task__discription",!0)}function Ct(){xt(".button-edit-project",".project","#project-editor",".project__title",".project__discription",!1)}function ut(e){let t=document.querySelector(".projects"),o=document.querySelector(".projects-task"),s=document.querySelector(".app-header__title"),n=e.target.closest(".project").querySelector(".project__title").textContent,a=document.querySelectorAll(".list-with-tasks__wrapper .task");$t(),document.querySelectorAll(`.list-with-tasks__wrapper .task[data-project="${n}"]`).forEach(r=>{r.classList.remove("task--hidden")}),a.forEach(r=>{(r.classList.contains("task--expired")||r.classList.contains("task--completed"))&&r.classList.add("task--hidden")}),t.style.display="none",o.style.display="block",o.dataset.project=n;let l="\u041F\u0440\u043E\u0435\u043A\u0442\u044B / "+n.slice(0,20)+(n.length>17?"...":"");s.textContent=l,document.querySelector(".button-back").classList.remove("tasks__header-button--active")}function pt(){let e=document.querySelector(".projects"),t=document.querySelector(".projects-task"),o=document.querySelector(".app-header__title"),s=document.querySelectorAll(".project__title");document.querySelectorAll(".manager-item").forEach(i=>{i.innerHTML=""}),K.forEach(i=>{i.classList.remove("new-item--disabled")}),t.style.display="none",e.style.display="block";let a=o.textContent;s.forEach((i,l)=>{let c=i.textContent,r=c.slice(0,20)+(c.length>17?"...":"");l===0?(a=a.replace("/ "+c,""),a=a.replace("/ "+r,"")):a.includes(" / "+c)&&(a=a.replace(" / "+c,""),a=a.replace(" / "+r,""))}),o.textContent=a}function $t(){let e=event.target.closest(".project").querySelector(".project__title").textContent;document.querySelectorAll(".list-with-tasks__wrapper .task").forEach(s=>{s.classList.add("task--hidden")}),document.querySelectorAll(`.list-with-tasks__wrapper .task[data-project="${e}"]`).forEach(s=>{s.classList.remove("task--hidden")})}var jt=document.querySelector("#task"),Dt=document.querySelector("#project"),Ut=document.querySelector("#project-editor"),Vt=document.querySelector("#task-editor"),wt=document.querySelectorAll(".list-with-tasks"),It=document.querySelectorAll(".projects__list");document.addEventListener("DOMContentLoaded",()=>{T("tasks").forEach(n=>{let a=Q();wt.forEach(i=>{let c=jt.content.cloneNode(!0).querySelector(".task");c.dataset.id=n.id,c.dataset.order=a,c.dataset.project=n.project,c.querySelector(".task__title").textContent=n.title,c.querySelector(".task__discription").textContent=n.description,c.querySelector(".task__data").textContent=n.date||"\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430",c.querySelector(".task__project").textContent=n.project;let r=c.querySelector(".task__circle");n.priority==="\u0421\u0440\u043E\u0447\u043D\u043E"?r.classList.add("task__circle--priority1"):n.priority==="\u0412\u0430\u0436\u043D\u043E"?r.classList.add("task__circle--priority2"):n.priority==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&r.classList.add("task__circle--priority3"),i.querySelector(".list-with-tasks__wrapper").appendChild(c),dt(),lt()})}),T("projects").forEach(n=>{It.forEach(a=>{let i=Dt.content.cloneNode(!0),l=i.querySelector(".project__title"),c=i.querySelector(".project__discription");l.textContent=n.title,c.textContent=n.description,a.querySelector(".projects__list-wrapper").appendChild(i),Ct(),bt()})}),document.querySelectorAll(".project__info-wrapper").forEach(n=>{n.addEventListener("click",ut)}),document.querySelector(".button-back").addEventListener("click",pt),at(),B(),_t(),Lt()});K.forEach(e=>{let t=e.querySelector(".new-item__task"),o=e.closest(".list"),s=o&&o.classList.contains("projects__list");t.addEventListener("click",()=>{let a=(s?Ut:Vt).content.cloneNode(!0),i=a.querySelector(".task-editor");if(i&&o){let c=o.querySelector(".manager-item");if(c){c.innerHTML="",c.appendChild(a),i.classList.add("task-editor--visible"),e.classList.add("new-item--disabled");let r=i.querySelector('[name="title_task"]'),y=i.querySelector('[name="discription_task"]'),p=i.querySelector(".task-editor__submit-btn"),x=document.createElement("span"),u=document.createElement("span");x.classList.add("task-editor__error"),u.classList.add("task-editor__error"),r.parentNode.appendChild(x),y.parentNode.appendChild(u),r.addEventListener("input",()=>{C(r,Y,x,j.TITLE,p),M(r,y,p)}),y.addEventListener("input",()=>{C(y,O,u,j.DISC,p),M(r,y,p)}),M(r,y,p),p.addEventListener("click",()=>{if(C(r,Y,x,j.TITLE,p),C(y,O,u,j.DISC,p),r.classList.contains("has-error")||y.classList.contains("has-error"))return;let f=r.value,k=y.value;if(s){let L={title:f,description:k};It.forEach(h=>{let v=Dt.content.cloneNode(!0);v.querySelector(".project__title").textContent=f,v.querySelector(".project__discription").textContent=k,h.querySelector(".projects__list-wrapper").appendChild(v)}),gt(L),document.querySelectorAll(".project__info-wrapper").forEach(h=>{h.addEventListener("click",ut)}),document.querySelector(".button-back").addEventListener("click",pt)}else{let L=mt(),D=Q();wt.forEach(w=>{let h=jt.content.cloneNode(!0),v=h.querySelector(".task");v.dataset.id=L,v.dataset.order=D;let N=h.querySelector(".task__title"),I=h.querySelector(".task__discription"),F=h.querySelector(".task__data"),b=h.querySelector(".task__project"),S=h.querySelector(".task__circle"),A=document.querySelector(".task-editor__priority-label"),d=i.querySelector('[name="data_task"]').value,m=i.querySelector('[name="priority_task"]').value,_=i.querySelector('[name="project_task"]').value;N.textContent=f,I.textContent=k,F.textContent=d,d||(F.textContent="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"),b.textContent=_,v.dataset.project=_,m==="\u0421\u0440\u043E\u0447\u043D\u043E"?S.classList.add("task__circle--priority1"):m==="\u0412\u0430\u0436\u043D\u043E"?S.classList.add("task__circle--priority2"):m==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&S.classList.add("task__circle--priority3"),A.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),w.querySelector(".list-with-tasks__wrapper").appendChild(h),dt(),lt(),Et(L)||St({id:L,order:D,title:f,description:k,date:d,priority:m,project:_})})}i.reset(),M(r,y,p),B(),U();let g=document.querySelector(".tasks__header-button--active");if(g){let L=g.textContent.trim();$(L)}at()}),s||X(yt()),G()}}let l=i.querySelector(".task-editor__close-btn");l&&l.addEventListener("click",()=>{i.classList.add("task-editor--hidden"),i.addEventListener("transitionend",function c(){i.remove(),e.classList.remove("new-item--disabled"),i.removeEventListener("transitionend",c)},{once:!0})})})});
