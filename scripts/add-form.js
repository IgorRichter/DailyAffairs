var kt=o=>o.key==="Escape",U=o=>t=>{kt(t)&&(t.preventDefault(),o())};function et(){return Math.random().toString(36).substr(2,9)}var ot=function(){let o=0;return function(){return o++,o}}(),nt=()=>{let o=new Date,t=o.getDate(),e=["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0432\u0440\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],n=o.getMonth(),c=e[n];return`${t} ${c}`};function j(o,t,e,n,c){o.value.trim().length>t?(e.textContent=n,o.classList.add("has-error"),c.disabled=!0):(e.textContent="",o.classList.remove("has-error"),c.disabled=!1)}function A(o,t,e){let n=o.value.trim()!=="",c=!o.classList.contains("has-error"),s=!t.classList.contains("has-error");e.disabled=!n||!c||!s}function rt(){let o=new Date,t={rendered:!1,localDate:new Date,prevMonthLastDate:null,calWeekDays:["\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431","\u0412\u0441"],calMonthName:["\u042F\u043D\u0432\u0430\u0440\u044C","\u0424\u0435\u0440\u0432\u0430\u043B\u044C","\u041C\u0430\u0440\u0442","\u0410\u043F\u0440\u0435\u043B\u044C","\u041C\u0430\u0439","\u0418\u044E\u043D\u044C","\u0418\u044E\u043B\u044C","\u0410\u0432\u0433\u0443\u0441\u0442","\u0421\u0435\u043D\u0442\u044F\u0431\u0440\u044C","\u041E\u043A\u0442\u044F\u0431\u0440\u044C","\u041D\u043E\u044F\u0431\u0440\u044C","\u0414\u0435\u043A\u0430\u0431\u0440\u044C"],daysInMonth:function(e,n){return new Date(n,e,0).getDate()},firstDay:function(){return new Date(o.getFullYear(),o.getMonth(),1)},lastDay:function(){return new Date(o.getFullYear(),o.getMonth()+1,0)},firstDayNumber:function(){let e=t.firstDay().getDay();return e===0?7:e},lastDayNumber:function(){return t.lastDay().getDay()+1},getPreviousMonthLastDate:function(){return new Date(o.getFullYear(),o.getMonth(),0).getDate()},navigateToPreviousMonth:function(){o.setMonth(o.getMonth()-1),t.attachEventsOnNextPrev()},navigateToNextMonth:function(){o.setMonth(o.getMonth()+1),t.attachEventsOnNextPrev()},navigateToCurrentMonth:function(){let e=t.localDate.getMonth(),n=t.localDate.getFullYear();o.setMonth(e),o.setYear(n),t.attachEventsOnNextPrev()},displayYear:function(){let e=document.querySelector(".calendar .calendar-year-label");e.innerHTML=o.getFullYear()},displayMonth:function(){let e=document.querySelector(".calendar .calendar-month-label");e.innerHTML=t.calMonthName[o.getMonth()]},plotSelectors:function(){let e=document.querySelector(".calendar"),n=document.createElement("div");n.classList.add("calendar-inner");let c=document.createElement("div");c.classList.add("calendar-controls");let s=document.createElement("div");s.classList.add("calendar-prev");let a=document.createElement("a");a.setAttribute("href","#");let i=document.createElementNS("http://www.w3.org/2000/svg","svg");i.setAttribute("xmlns","http://www.w3.org/2000/svg"),i.setAttribute("width","128"),i.setAttribute("height","128"),i.setAttribute("viewBox","0 0 128 128");let l=document.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("fill","#666"),l.setAttribute("d","M88.2 3.8L35.8 56.23 28 64l7.8 7.78 52.4 52.4 9.78-7.76L45.58 64l52.4-52.4z"),i.appendChild(l),a.appendChild(i),s.appendChild(a);let r=document.createElement("div");r.classList.add("calendar-year-month");let k=document.createElement("div");k.classList.add("calendar-month-label");let _=document.createElement("div");_.textContent="-";let x=document.createElement("div");x.classList.add("calendar-year-label"),r.appendChild(k),r.appendChild(_),r.appendChild(x);let u=document.createElement("div");u.classList.add("calendar-next");let h=document.createElement("a");h.setAttribute("href","#");let m=document.createElementNS("http://www.w3.org/2000/svg","svg");m.setAttribute("xmlns","http://www.w3.org/2000/svg"),m.setAttribute("width","128"),m.setAttribute("height","128"),m.setAttribute("viewBox","0 0 128 128");let g=document.createElementNS("http://www.w3.org/2000/svg","path");g.setAttribute("fill","#666"),g.setAttribute("d","M38.8 124.2l52.4-52.42L99 64l-7.77-7.78-52.4-52.4-9.8 7.77L81.44 64 29 116.42z"),m.appendChild(g),h.appendChild(m),u.appendChild(h),c.appendChild(s),c.appendChild(r),c.appendChild(u);let L=document.createElement("div");L.classList.add("calendar-body"),n.appendChild(c),n.appendChild(L),e.appendChild(n)},plotDayNames:function(){let e=document.querySelector(".calendar .calendar-body");t.calWeekDays.forEach(n=>{let c=document.createElement("div");c.textContent=n,e.appendChild(c)})},plotDates:function(){let e=document.querySelector(".calendar .calendar-body");t.rendered||(t.plotSelectors(),t.rendered=!0),e.innerHTML="",t.plotDayNames(),t.displayMonth(),t.displayYear();let n=1,c=0;t.prevMonthLastDate=t.getPreviousMonthLastDate();let s=[],a=t.daysInMonth(o.getMonth()+1,o.getFullYear());for(let i=1;i<a;i++)if(i<t.firstDayNumber()){c+=1;let l=document.createElement("div");l.classList.add("prev-dates"),e.appendChild(l),s.push(t.prevMonthLastDate--)}else{let l=document.createElement("div");l.classList.add("number-item"),l.setAttribute("data-num",n);let r=document.createElement("a");r.classList.add("dateNumber"),r.href="#",r.textContent=n++,l.appendChild(r),e.appendChild(l)}for(let i=0;i<c+1;i++){let l=document.createElement("div");l.classList.add("number-item"),l.setAttribute("data-num",n);let r=document.createElement("a");r.classList.add("dateNumber"),r.href="#",r.textContent=n++,l.appendChild(r),e.appendChild(l)}t.highlightToday(),t.plotPrevMonthDates(s),t.plotNextMonthDates()},attachEvents:function(){let e=document.querySelector(".calendar .calendar-prev a"),n=document.querySelector(".calendar .calendar-next a"),c=document.querySelectorAll(".calendar .dateNumber");e.addEventListener("click",t.navigateToPreviousMonth),n.addEventListener("click",t.navigateToNextMonth);for(var s=0;s<c.length;s++)c[s].addEventListener("click",t.selectDate,!1)},highlightToday:function(){let e=t.localDate.getMonth()+1,n=o.getMonth()+1,c=t.localDate.getFullYear(),s=o.getFullYear();c===s&&e===n&&document.querySelectorAll(".number-item")&&document.querySelectorAll(".number-item")[o.getDate()-1].classList.add("calendar-today")},plotPrevMonthDates:function(e){e.reverse();for(let n=0;n<e.length;n++)document.querySelectorAll(".prev-dates")&&(document.querySelectorAll(".prev-dates")[n].textContent=e[n])},plotNextMonthDates:function(){let e=document.querySelector(".calendar-body").childElementCount;if(e>42){let n=49-e;t.loopThroughNextDays(n)}if(e>35&&e<=42){let n=42-e;t.loopThroughNextDays(42-e)}},loopThroughNextDays:function(e){let n=document.querySelector(".calendar-body");if(e>0)for(let c=1;c<=e;c++){let s=document.createElement("div");s.classList.add("next-dates"),s.textContent=c,n.appendChild(s)}},attachEventsOnNextPrev:function(){t.plotDates(),t.attachEvents()},init:function(){t.rendered||(t.plotSelectors(),t.rendered=!0),t.plotDates(),t.attachEvents()}};t.init()}function V(){document.querySelectorAll(".editor").forEach(t=>{t.addEventListener("input",()=>{t.style.height="auto",t.style.height=t.scrollHeight+"px"})})}function W(o){let t=document.getElementById("dateInput"),e=document.querySelector(".calendar"),n=document.getElementById("priorityInput"),c=document.querySelector(".popup-priority"),s=document.querySelectorAll(".popup-priority__item"),a=document.querySelector(".task-editor__priority-label"),i=document.getElementById("projectInput"),l=document.querySelector(".popup-project"),r=document.querySelector(".popup-project__list"),k=document.querySelector(".popup-project_btn-reset"),_=document.querySelector(".popup-project__list-empty"),x=new rt;function u(d,p,v){return function(D){D.stopPropagation(),d.classList.contains("task-editor__popup--open")?v():p()}}if(n.addEventListener("click",u(c,y,f)),!i.closest(".list-in-project"))i.addEventListener("click",u(l,I,E));else{let d=document.querySelector(".projects-task").dataset.project;i.value=d}k.addEventListener("click",()=>{i.value="";let p=document.querySelector(".task-editor").dataset.taskId,v=document.querySelector(`.task[data-id="${p}"]`);v&&delete v.dataset.project,E()}),s.forEach(function(d){d.addEventListener("click",function(){let p=d.textContent.trim();switch(n.value=p,a.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),p){case"\u0421\u0440\u043E\u0447\u043D\u043E":a.classList.add("task-editor__priority-label--priority1");break;case"\u0412\u0430\u0436\u043D\u043E":a.classList.add("task-editor__priority-label--priority2");break;case"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":a.classList.add("task-editor__priority-label--priority3");break;default:break}f()})}),t.value=o,t.addEventListener("click",()=>{e.style.display==="block"?T():N()}),e.addEventListener("click",function(d){if(d.target.classList.contains("dateNumber")){let p=d.target.textContent.trim(),v=e.querySelector(".calendar-month-label").textContent.trim();t.value=`${p} ${v}`,T()}});let h=U(f),m=U(E),g=U(T);function L(){T(),f(),E()}function q(d,p){L(),d.classList.add("task-editor__popup--open"),document.addEventListener("keydown",p)}function C(d,p){d.classList.remove("task-editor__popup--open"),document.removeEventListener("keydown",p)}function y(){q(c,h)}function f(){C(c,h)}function I(){q(l,m),S()}function E(){C(l,m)}function N(){L(),e.style.display="block",document.addEventListener("keydown",g)}function T(){e.style.display="none",document.removeEventListener("keydown",g)}function S(){let p=document.querySelector(".projects__list-wrapper").querySelectorAll(".project__title");r.innerHTML="",p.forEach(v=>{let D=document.createElement("li");D.classList.add("popup-project__item");let K=document.createElement("span");K.textContent=v.textContent.trim(),D.appendChild(K),r.appendChild(D),D.addEventListener("click",function(){let P=D.textContent.trim();i.value=P,E()})}),M()}function M(){document.querySelectorAll(".popup-project__list li").length===0?_.style.display="block":_.style.display="none"}document.addEventListener("click",function(d){!c.contains(d.target)&&d.target!==n&&f(),!l.contains(d.target)&&d.target!==i&&E(),!e.contains(d.target)&&d.target!==t&&T()})}var Pt=document.querySelector(".sidebar"),G=document.querySelectorAll(".new-item"),F=100,Y=500,w={TITLE:"\u0414\u043B\u0438\u043D\u0430 \u0437\u0430\u0433\u043E\u043B\u043E\u0432\u043A\u0430 \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 100 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432.",DISC:"\u0414\u043B\u0438\u043D\u0430 \u043E\u043F\u0438\u0441\u0430\u043D\u0438\u044F \u043D\u0435 \u0434\u043E\u043B\u0436\u043D\u0430 \u043F\u0440\u0435\u0432\u044B\u0448\u0430\u0442\u044C 500 \u0441\u0438\u043C\u0432\u043E\u043B\u043E\u0432."};var Q=document.querySelector(".button-date"),z=Q.querySelector(".button-date__title"),R=Q.querySelector(".button-date__arrow--left"),J=Q.querySelector(".button-date__arrow--right"),_t=document.querySelector(".dashboard .list-with-tasks__wrapper"),b=new Date;Z();B();J.addEventListener("click",function(){J.classList.contains("button-date__arrow--disabled")||(b.setDate(b.getDate()+1),Z(),B())});R.addEventListener("click",function(){R.classList.contains("button-date__arrow--disabled")||(b.setDate(b.getDate()-1),Z(),B())});function Z(){let o=new Date,t=new Date(o);t.setDate(t.getDate()+1),X(b,o)?z.textContent="\u0421\u0435\u0433\u043E\u0434\u043D\u044F":X(b,t)?z.textContent="\u0417\u0430\u0432\u0442\u0440\u0430":z.textContent=vt(b),ft()}function ft(){let o=new Date,t="button-date__arrow--disabled";R.classList.toggle(t,X(b,o)),J.classList.toggle(t,Lt(b,o))}function B(){let o=_t.querySelectorAll(".task"),t=/(\d+)\s+(\S+)/;o.forEach(e=>{let n=e.querySelector(".task__data").textContent;if(n.trim()==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){e.classList.add("task--hidden");return}if(e.classList.contains("task--completed")){e.classList.add("task--hidden");return}let[,c,s]=n.match(t),a=new Date(b.getFullYear(),tt(s),parseInt(c));X(b,a)?e.classList.remove("task--hidden"):e.classList.add("task--hidden")})}function vt(o){let t={weekday:"long",month:"long",day:"numeric"};return o.toLocaleDateString("ru-RU",t)}function X(o,t){return o.getFullYear()===t.getFullYear()&&o.getMonth()===t.getMonth()&&o.getDate()===t.getDate()}function Lt(o,t){let e=new Date(t.getFullYear(),t.getMonth(),t.getDate()+7);return o>=e}function tt(o){return["\u042F\u043D\u0432","\u0424\u0435\u0432","\u041C\u0430\u0440","\u0410\u043F\u0440","\u041C\u0430\u0439","\u0418\u044E\u043D","\u0418\u044E\u043B","\u0410\u0432\u0433","\u0421\u0435\u043D","\u041E\u043A\u0442","\u041D\u043E\u044F","\u0414\u0435\u043A"].indexOf(o)}var st=document.querySelectorAll(".tasks__header-button"),at=document.querySelector(".tasks .list-with-tasks__wrapper");st.forEach(o=>{o.addEventListener("click",function(){st.forEach(t=>t.classList.remove("tasks__header-button--active")),o.classList.add("tasks__header-button--active"),H(o.textContent.trim())})});function H(o){at.querySelectorAll(".task").forEach(e=>{o==="\u0417\u0430\u0432\u0435\u0440\u0448\u0435\u043D\u043D\u044B\u0435"?e.classList.contains("task--completed")?e.classList.remove("task--hidden"):e.classList.add("task--hidden"):o==="\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0435"?e.classList.contains("task--completed")||e.classList.contains("task--expired")?e.classList.add("task--hidden"):e.classList.remove("task--hidden"):o==="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&(e.classList.contains("task--expired")?e.classList.remove("task--hidden"):e.classList.add("task--hidden"))})}function St(o){let t=o.querySelector(".task__title"),e=o.dataset.id;o.classList.add("task--completed");let n=document.createElement("s");n.textContent=t.textContent,t.textContent="",t.appendChild(n),o.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#arrow-back"),o.style.transition="opacity 0.3s ease",o.style.opacity="0",setTimeout(()=>{o.classList.add("task--completed","task--hidden"),o.style.transition="",o.style.opacity=""},300),document.querySelectorAll('.list-with-tasks__wrapper .task[data-id="'+e+'"]').forEach(a=>{a.classList.add("task--completed");let i=a.querySelector(".task__title");if(!i.querySelector("s")){let r=document.createElement("s");r.textContent=i.textContent,i.textContent="",i.appendChild(r)}if(a.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#arrow-back"),a.classList.contains("task--expired")){a.classList.remove("task--expired");let r=a.querySelector(".task__info-expired");r&&r.remove()}})}function ct(){document.querySelectorAll(".button-complete-task").forEach(t=>{t.addEventListener("click",function(e){let n=e.target.closest(".task");n.classList.contains("task--completed")?gt(n):St(n)})})}function gt(o){let t=o.querySelector(".task__title s");t&&(t.parentNode.textContent=t.textContent),o.classList.remove("task--completed"),o.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#checkmark");let n=o.dataset.id;document.querySelectorAll('.list-with-tasks__wrapper .task[data-id="'+n+'"]').forEach(a=>{let i=a.querySelector(".task__title s");i&&(i.parentNode.textContent=i.textContent),a.classList.remove("task--completed"),a.querySelector(".task__circle svg").querySelector("use").setAttribute("href","icons/stack.svg#checkmark")});let s=document.querySelector(".tasks__header-button--active");if(s){let a=s.textContent.trim();H(a)}$()}function $(){let o=at.querySelectorAll(".task"),t=new Date;t.setHours(0,0,0,0),o.forEach(e=>{let n=e.querySelector(".task__data").textContent.trim();if(n==="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"){e.classList.add("task--hidden");return}let[,c,s]=n.match(/(\d+)\s+(\S+)/);if(new Date(t.getFullYear(),tt(s),parseInt(c)).getTime()<t.getTime()){e.classList.add("task--expired");let i=e.querySelector(".task__info-wrapper");if(!i.querySelector(".task__info-expired")){let r=document.createElement("span");r.classList.add("task__info-expired"),r.textContent="\u0417\u0430\u0434\u0430\u0447\u0430 \u043F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u0430",i.insertBefore(r,i.firstChild)}let l=document.querySelector(".tasks__header-button--active");l&&l.textContent!=="\u041F\u0440\u043E\u0441\u0440\u043E\u0447\u0435\u043D\u043D\u044B\u0435"&&e.classList.add("task--hidden")}else{e.classList.remove("task--expired");let i=e.querySelector(".task__info-expired");i&&i.remove()}})}function it(o,t,e=null){document.querySelectorAll(o).forEach(c=>{c.addEventListener("click",()=>{let s=c.closest(t);if(s)if(e){let a=s.dataset.id;document.querySelectorAll(`${t}[${e}="${a}"]`).forEach(l=>{l.remove()})}else s.remove()})})}function lt(o,t,e,n,c,s){let a=document.querySelectorAll(o),i=document.querySelector(e);a.forEach(l=>{l.addEventListener("click",()=>{let r=l.closest(t);if(r.classList.add(`${t.slice(1)}--edit`),r){let k=r.dataset.id,_=r.querySelector(n).textContent.trim(),x=r.querySelector(c).textContent.trim(),u=i.content.cloneNode(!0).querySelector(".task-editor"),h=u.querySelector('[name="title_task"]'),m=u.querySelector('[name="discription_task"]'),g=u.querySelector('[name="data_task"]'),L=u.querySelector('[name="priority_task"]'),q=u.querySelector('[name="project_task"]'),C=u.querySelector(".task-editor__priority-label"),y=u.querySelector(".task-editor__submit-btn"),f=document.createElement("span"),I=document.createElement("span");h.value=_,m.value=x,f.classList.add("task-editor__error"),I.classList.add("task-editor__error"),h.parentNode.appendChild(f),m.parentNode.appendChild(I),h.addEventListener("input",()=>{j(h,F,f,w.TITLE,y),A(h,m,y)}),m.addEventListener("input",()=>{j(m,Y,I,w.DISC,y),A(h,m,y)}),A(h,m,y),y.querySelector("use").setAttribute("href","icons/stack.svg#checkmark"),y.addEventListener("click",()=>{if(j(h,F,f,w.TITLE,y),j(m,Y,I,w.DISC,y),h.classList.contains("has-error")||m.classList.contains("has-error"))return;let S=h.value.trim(),M=m.value.trim();if(r.querySelector(n).textContent=S,r.querySelector(c).textContent=M,s){let p=g.value.trim(),v=L.value.trim(),D=q.value.trim();document.querySelectorAll(`.task[data-id="${k}"]`).forEach(P=>{P.querySelector(".task__title").textContent=S,P.querySelector(".task__discription").textContent=M,P.querySelector(".task__data").textContent=p,P.querySelector(".task__project").textContent=D,P.dataset.project=D;let O=P.querySelector(".task__circle");O.classList.remove("task__circle--priority1","task__circle--priority2","task__circle--priority3"),v==="\u0421\u0440\u043E\u0447\u043D\u043E"?O.classList.add("task__circle--priority1"):v==="\u0412\u0430\u0436\u043D\u043E"?O.classList.add("task__circle--priority2"):v==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&O.classList.add("task__circle--priority3")})}u.classList.add("task-editor--hidden"),u.addEventListener("transitionend",function p(){r.classList.remove(`${t.slice(1)}--edit`),u.remove(),u.removeEventListener("transitionend",p)},{once:!0}),B(),$();let d=document.querySelector(".tasks__header-button--active");if(d){let p=d.textContent.trim();H(p)}});let N=r.closest(".list, .projects__list").querySelector(".manager-item");N.innerHTML="",N.appendChild(u),u.classList.add("task-editor--visible");let T=u.querySelector(".task-editor__close-btn");if(T&&T.addEventListener("click",()=>{u.classList.add("task-editor--hidden"),u.addEventListener("transitionend",function S(){r.classList.remove(`${t.slice(1)}--edit`),u.remove(),u.removeEventListener("transitionend",S)},{once:!0})}),s){let S=r.querySelector(".task__data").textContent.trim(),M=r.querySelector(".task__project").textContent.trim(),d=r.querySelector(".task__circle").classList.contains("task__circle--priority1")?"\u0421\u0440\u043E\u0447\u043D\u043E":r.querySelector(".task__circle").classList.contains("task__circle--priority2")?"\u0412\u0430\u0436\u043D\u043E":r.querySelector(".task__circle").classList.contains("task__circle--priority3")?"\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E":"";g.value=S,q.value=M,L.value=d,d==="\u0421\u0440\u043E\u0447\u043D\u043E"?C.classList.add("task-editor__priority-label--priority1"):d==="\u0412\u0430\u0436\u043D\u043E"?C.classList.add("task-editor__priority-label--priority2"):d==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&C.classList.add("task-editor__priority-label--priority3"),W(S)}V()}})})}function dt(){it(".button-delete-task",".task","data-id")}function ut(){it(".button-delete-project",".project")}function pt(){lt(".button-edit-task",".task","#task-editor",".task__title",".task__discription",!0)}function mt(){lt(".button-edit-project",".project","#project-editor",".project__title",".project__discription",!1)}function yt(o){let t=document.querySelector(".projects"),e=document.querySelector(".projects-task"),n=document.querySelector(".app-header__title"),c=o.target.closest(".project").querySelector(".project__title").textContent,s=document.querySelectorAll(".list-with-tasks__wrapper .task");qt(),document.querySelectorAll(`.list-with-tasks__wrapper .task[data-project="${c}"]`).forEach(r=>{r.classList.remove("task--hidden")}),s.forEach(r=>{(r.classList.contains("task--expired")||r.classList.contains("task--completed"))&&r.classList.add("task--hidden")}),t.style.display="none",e.style.display="block",e.dataset.project=c;let i="\u041F\u0440\u043E\u0435\u043A\u0442\u044B / "+c.slice(0,20)+(c.length>17?"...":"");n.textContent=i,document.querySelector(".button-back").classList.remove("tasks__header-button--active")}function ht(){let o=document.querySelector(".projects"),t=document.querySelector(".projects-task"),e=document.querySelector(".app-header__title"),n=document.querySelectorAll(".project__title");document.querySelectorAll(".manager-item").forEach(a=>{a.innerHTML=""}),G.forEach(a=>{a.classList.remove("new-item--disabled")}),t.style.display="none",o.style.display="block";let s=e.textContent;n.forEach((a,i)=>{let l=a.textContent,r=l.slice(0,20)+(l.length>17?"...":"");i===0?(s=s.replace("/ "+l,""),s=s.replace("/ "+r,"")):s.includes(" / "+l)&&(s=s.replace(" / "+l,""),s=s.replace(" / "+r,""))}),e.textContent=s}function qt(){let o=event.target.closest(".project").querySelector(".project__title").textContent;document.querySelectorAll(".list-with-tasks__wrapper .task").forEach(n=>{n.classList.add("task--hidden")}),document.querySelectorAll(`.list-with-tasks__wrapper .task[data-project="${o}"]`).forEach(n=>{n.classList.remove("task--hidden")})}var Et=document.querySelector("#task"),bt=document.querySelector("#project"),xt=document.querySelector("#project-editor"),Ct=document.querySelector("#task-editor"),Tt=document.querySelectorAll(".list-with-tasks"),Dt=document.querySelectorAll(".projects__list");G.forEach(o=>{let t=o.querySelector(".new-item__task"),e=o.closest(".list"),n=e&&e.classList.contains("projects__list");t.addEventListener("click",()=>{let s=(n?xt:Ct).content.cloneNode(!0),a=s.querySelector(".task-editor");if(a&&e){let l=e.querySelector(".manager-item");if(l){l.innerHTML="",l.appendChild(s),a.classList.add("task-editor--visible"),o.classList.add("new-item--disabled");let r=a.querySelector('[name="title_task"]'),k=a.querySelector('[name="discription_task"]'),_=a.querySelector(".task-editor__submit-btn"),x=document.createElement("span"),u=document.createElement("span");x.classList.add("task-editor__error"),u.classList.add("task-editor__error"),r.parentNode.appendChild(x),k.parentNode.appendChild(u),r.addEventListener("input",()=>{j(r,F,x,w.TITLE,_),A(r,k,_)}),k.addEventListener("input",()=>{j(k,Y,u,w.DISC,_),A(r,k,_)}),A(r,k,_),_.addEventListener("click",()=>{if(j(r,F,x,w.TITLE,_),j(k,Y,u,w.DISC,_),r.classList.contains("has-error")||k.classList.contains("has-error"))return;let h=r.value,m=k.value;if(n)Dt.forEach(L=>{let q=bt.content.cloneNode(!0),C=q.querySelector(".project__title"),y=q.querySelector(".project__discription");C.textContent=h,y.textContent=m,L.querySelector(".projects__list-wrapper").appendChild(q),document.querySelectorAll(".project__info-wrapper").forEach(E=>{E.addEventListener("click",yt)}),document.querySelector(".button-back").addEventListener("click",ht),mt(),ut()});else{let L=et(),q=ot();Tt.forEach(C=>{let y=Et.content.cloneNode(!0),f=y.querySelector(".task");f.dataset.id=L,f.dataset.order=q;let I=y.querySelector(".task__title"),E=y.querySelector(".task__discription"),N=y.querySelector(".task__data"),T=y.querySelector(".task__project"),S=y.querySelector(".task__circle"),M=document.querySelector(".task-editor__priority-label"),d=a.querySelector('[name="data_task"]').value,p=a.querySelector('[name="priority_task"]').value,v=a.querySelector('[name="project_task"]').value;I.textContent=h,E.textContent=m,N.textContent=d,d||(N.textContent="\u0411\u0435\u0437 \u0441\u0440\u043E\u043A\u0430"),T.textContent=v,f.dataset.project=v,p==="\u0421\u0440\u043E\u0447\u043D\u043E"?S.classList.add("task__circle--priority1"):p==="\u0412\u0430\u0436\u043D\u043E"?S.classList.add("task__circle--priority2"):p==="\u0412\u0442\u043E\u0440\u043E\u0441\u0442\u0435\u043F\u0435\u043D\u043D\u043E"&&S.classList.add("task__circle--priority3"),M.classList.remove("task-editor__priority-label--priority1","task-editor__priority-label--priority2","task-editor__priority-label--priority3"),C.querySelector(".list-with-tasks__wrapper").appendChild(y),pt(),dt()})}a.reset(),A(r,k,_),B(),$();let g=document.querySelector(".tasks__header-button--active");if(g){let L=g.textContent.trim();H(L)}ct()}),n||W(nt()),V()}}let i=a.querySelector(".task-editor__close-btn");i&&i.addEventListener("click",()=>{a.classList.add("task-editor--hidden"),a.addEventListener("transitionend",function l(){a.remove(),o.classList.remove("new-item--disabled"),a.removeEventListener("transitionend",l)},{once:!0})})})});
